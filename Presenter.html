
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Eco-Activist's Toolkit</title>
    <!-- External Dependencies: Font Awesome Kit for icons and Google Fonts for typography -->
    <script src="https://kit.fontawesome.com/58a810656e.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Questrial&display=swap" rel="stylesheet">
    
    <style>
   /* =====================================================================
           Organic Sage UI â€” Mobile-first, stable, and soothing
           Palette preserved; accessibility + mobile ergonomics improved.
           (Strictly adhering to provided CSS)
           ===================================================================== */

      /* ------------------------------- Design tokens ----------------------------------*/
      :root {
        --primary-sage: #7a8471;
        --secondary-sage: #9caf88;
        --tertiary-sage: #b8c5a6;
        --warm-cream: #f8f6f0;
        --soft-white: #fefcf7;
        --forest-shadow: #5a6b52;
        --border-sage: rgba(122, 132, 113, 0.2);
        --hover-sage: rgba(156, 175, 136, 0.15);

        --deep-forest: #3e4a3a;
        --moss: #6e7a67;
        --fern: #8fa081;
        --dried-clay: #d9cdb4;
        --amber: #c6aa77;
        --ink: #2f3a2b;
        --ink-muted: #5a6b52;

        --font-display:
          "Questrial", system-ui, -apple-system, Segoe UI, Roboto,
          "Helvetica Neue", Arial, sans-serif;
        --font-body:
          "Nunito", system-ui, -apple-system, Segoe UI, Roboto,
          "Helvetica Neue", Arial, sans-serif;

        --step--2: clamp(0.75rem, 0.7rem + 0.12vw, 0.84rem);
        --step--1: clamp(0.875rem, 0.84rem + 0.15vw, 0.95rem);
        --step-0: clamp(1rem, 0.96rem + 0.22vw, 1.1rem);
        --step-1: clamp(1.125rem, 1.07rem + 0.35vw, 1.3rem);
        --step-2: clamp(1.375rem, 1.28rem + 0.55vw, 1.6rem);
        --step-3: clamp(1.75rem, 1.58rem + 0.95vw, 2.1rem);
        --step-4: clamp(2.25rem, 1.98rem + 1.35vw, 2.7rem);
        --step-5: clamp(2.85rem, 2.4rem + 1.9vw, 3.6rem);

        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-7: 2rem;
        --space-8: 2.5rem;
        --space-9: 3rem;

        --radius-sm: 10px;
        --radius: 16px;
        --radius-lg: 20px;
        --radius-xl: 28px;

        --shadow-1:
          0 1px 2px rgba(34, 41, 32, 0.05), 0 2px 8px rgba(34, 41, 32, 0.06);
        --shadow-2:
          0 4px 18px rgba(34, 41, 32, 0.08), 0 12px 28px rgba(34, 41, 32, 0.06);
        --shadow-3:
          0 10px 40px rgba(34, 41, 32, 0.1), 0 20px 60px rgba(34, 41, 32, 0.08);

        --ring:
          0 0 0 3px color-mix(in oklab, var(--soft-white) 60%, transparent),
          0 0 0 5px color-mix(in srgb, var(--secondary-sage), #2f3a2b 15%);

        --ease-ambient: cubic-bezier(0.2, 0.8, 0.2, 1);
        --dur-1: 120ms;
        --dur-2: 200ms;
        --dur-3: 320ms;

        --target-min: 44px;
        --container-max: clamp(720px, 64vw, 1080px);
        --workspace-max: 1500px;
      }

      /* ------------------------------- Global reset / mobile stability ----------------------------------*/
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;
        hanging-punctuation: first last;
      }
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        min-height: 100dvh;
        font-family: var(--font-body);
        font-size: var(--step-0);
        line-height: 1.6;
        color: var(--forest-shadow);
        background:
          radial-gradient(
            1200px 1200px at -10% -10%,
            #ffffff 0%,
            transparent 50%
          ),
          radial-gradient(
            1200px 1000px at 110% 10%,
            #fff8f0 0%,
            transparent 50%
          ),
          linear-gradient(135deg, #f8f6f0 0%, #f5f3ed 100%);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
        overflow-x: hidden;
      }
      @media (prefers-reduced-motion: no-preference) {
        html {
          scroll-behavior: smooth;
        }
      }
      :where(p, h1, h2, h3, h4, h5, h6) {
        text-wrap: pretty;
        overflow-wrap: anywhere;
      }
      img,
      svg,
      video,
      canvas,
      audio,
      iframe {
        display: block;
        max-width: 100%;
        height: auto;
      }
      a {
        color: var(--primary-sage);
        text-decoration-thickness: 1px;
        text-underline-offset: 2px;
      }
      a:hover {
        color: var(--deep-forest);
      }
      .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
      }

      /* ------------------------------- Typography utilities ----------------------------------*/
      .text-lead {
        font-size: var(--step-1);
        line-height: 1.7;
        font-weight: 600;
        color: var(--forest-shadow);
      }
      .text-muted {
        color: var(--ink-muted);
      }
      .text-measure {
        max-width: 62ch;
      }
      .text-eyebrow {
        font-size: var(--step--2);
        font-weight: 800;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: color-mix(in srgb, var(--forest-shadow) 82%, white 18%);
      }
      .text-caption {
        font-size: var(--step--2);
        line-height: 1.4;
        color: color-mix(in srgb, var(--forest-shadow) 70%, white 30%);
      }

      /* ------------------------------- Text containers ----------------------------------*/
      .textbox {
        display: grid;
        gap: var(--space-2);
        padding: clamp(18px, 2.2vw, 26px);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: color-mix(in srgb, var(--soft-white) 92%, white 8%);
        box-shadow: var(--shadow-1);
      }
      .textbox--outline {
        border-style: solid;
        border-color: color-mix(in srgb, var(--secondary-sage) 55%, white 45%);
        background: color-mix(in srgb, var(--soft-white) 82%, white 18%);
      }
      .textbox--tonal {
        background: color-mix(in srgb, rgba(248, 246, 240, 0.9) 65%, rgba(156, 175, 136, 0.15) 35%);
      }
      .textbox--accent {
        border-color: color-mix(in srgb, var(--amber) 60%, var(--dried-clay) 40%);
        background: color-mix(in srgb, rgba(255, 247, 235, 0.85) 60%, rgba(198, 170, 119, 0.2) 40%);
        box-shadow: var(--shadow-2);
      }
      .textbox--ghost {
        background: transparent;
        box-shadow: none;
        border-style: dashed;
        border-color: rgba(90, 107, 82, 0.24);
      }


      /* ------------------------------- App shell ----------------------------------*/
      #app-wrapper {
        display: flex;
        justify-content: center;
        align-items: stretch;
        padding: max(var(--space-7), env(safe-area-inset-top)) var(--space-4)
          var(--space-7);
        width: 100%;
        min-height: 100dvh;
        background:
          radial-gradient(
            800px 600px at 20% 0%,
            rgba(156, 175, 136, 0.08) 0%,
            transparent 70%
          ),
          radial-gradient(
            700px 500px at 80% 100%,
            rgba(90, 107, 82, 0.06) 0%,
            transparent 65%
          );
      }
      .skip-link {
        position: absolute;
        top: var(--space-3);
        left: 50%;
        transform: translate(-50%, -150%);
        background: var(--forest-shadow);
        color: #fff;
        padding: var(--space-2) var(--space-4);
        border-radius: var(--radius-sm);
        font-weight: 700;
        z-index: 1000;
        transition: transform var(--dur-1) var(--ease-ambient);
      }
      .skip-link:focus {
        transform: translate(-50%, 0);
      }
      #activity-shell {
        width: min(100%, var(--workspace-max));
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-6);
        align-items: stretch;
      }
      #activity-container {
        width: min(100%, clamp(960px, 96vw, var(--workspace-max)));
        background: color-mix(in srgb, var(--soft-white) 88%, white 12%);
        padding: clamp(20px, 2.5vw, 40px);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.12);
        box-shadow: var(--shadow-2);
        position: relative;
        isolation: isolate;
        container-type: inline-size;
        display: flex;
        flex-direction: column;
        min-height: 0;
        height: auto;
        min-width: 0;
      }
      .session-hero {
        position: relative;
        overflow: hidden;
        display: grid;
        gap: clamp(20px, 3vw, 40px);
        grid-template-columns: minmax(0, 1fr);
        align-items: center;
        margin-top: clamp(8px, 1.5vw, 16px);
        padding: clamp(28px, 4vw, 48px);
        border-radius: var(--radius-xl);
        background:
          linear-gradient(
            140deg,
            rgba(255, 246, 233, 0.88),
            rgba(156, 175, 136, 0.25)
          ),
          radial-gradient(
            320px 220px at 10% 15%,
            rgba(198, 170, 119, 0.35),
            transparent 70%
          ),
          linear-gradient(160deg, rgba(122, 132, 113, 0.12), transparent 60%);
        box-shadow: var(--shadow-3);
        color: var(--deep-forest);
        isolation: isolate;
      }
      .session-hero::after {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(
          420px 280px at 85% 15%,
          rgba(255, 255, 255, 0.5),
          transparent 72%
        );
        opacity: 0.7;
        pointer-events: none;
      }
      .session-hero__content {
        position: relative;
        z-index: 1;
        display: grid;
        gap: clamp(12px, 2vw, 20px);
        max-width: clamp(320px, 55%, 520px);
      }
      .session-hero__eyebrow {
        margin: 0;
        font-size: var(--step--1);
        letter-spacing: 0.24em;
        text-transform: uppercase;
        font-weight: 800;
        color: color-mix(in srgb, var(--deep-forest) 80%, white 20%);
      }
      .session-hero__title {
        margin: 0;
        font-family: var(--font-display);
        font-size: clamp(2.2rem, 2.6vw, 3rem);
        line-height: 1.15;
        color: var(--deep-forest);
        text-wrap: balance;
      }
      .session-hero__descriptor {
        margin: 0;
        font-size: var(--step-1);
        color: color-mix(
          in srgb,
          var(--deep-forest) 72%,
          rgba(255, 255, 255, 0.2) 28%
        );
        max-width: 52ch;
      }
      .session-hero__meta {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: var(--space-2);
      }
      .session-hero__meta[hidden] {
        display: none;
      }
      .session-hero__badge {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: 6px 14px;
        border-radius: 999px;
        background: rgba(47, 58, 43, 0.16);
        font-weight: 700;
        font-size: var(--step--1);
        letter-spacing: 0.02em;
      }
      .session-hero__badge i {
        font-size: 0.85em;
      }
      .session-hero__subtitle {
        font-size: var(--step--1);
        color: color-mix(
          in srgb,
          var(--deep-forest) 70%,
          rgba(255, 255, 255, 0.25) 30%
        );
        padding: 6px 0;
      }
      .session-hero__subtitle[hidden] {
        display: none;
      }
      .session-hero__media {
        position: relative;
        z-index: 1;
        margin: 0;
        justify-self: center;
        max-width: min(380px, 60vw);
        border-radius: clamp(18px, 3vw, 32px);
        overflow: hidden;
        box-shadow: 0 24px 50px rgba(62, 74, 58, 0.28);
      }
      .session-hero__media img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .session-hero__media img[hidden] {
        display: none;
      }
      .session-hero--no-image .session-hero__media {
        display: none;
      }
      @media (min-width: 1024px) {
        .session-hero {
          grid-template-columns: 1fr minmax(240px, 360px);
        }
        .session-hero__content {
          max-width: 520px;
        }
      }
      @supports (backdrop-filter: blur(6px)) {
        #activity-container {
          background: color-mix(in srgb, var(--soft-white) 76%, white 24%);
          backdrop-filter: blur(6px) saturate(1.02);
        }
      }
      #slide-stage {
        flex: 1 1 auto;
        width: 100%;
        min-width: 0;
        min-height: 0;
        display: flex;
        align-items: stretch;
        justify-content: center;
        padding: clamp(16px, 2.5vw, 32px);
        margin-top: clamp(16px, 2vw, 28px);
      }
      #slide-stage-shell {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
        width: 100%;
        min-height: 0;
      }
      #slides-root {
        position: relative;
        width: 100%;
        max-width: 100%;
        flex: 1 1 auto;
        min-height: 0;
        background: color-mix(in srgb, var(--soft-white) 94%, white 6%);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-2);
        padding: clamp(24px, 3vw, 44px);
        overflow: visible;
      }
      #slides-root::-webkit-scrollbar {
        width: 10px;
      }
      #slides-root::-webkit-scrollbar-track {
        background: rgba(122, 132, 113, 0.1);
        border-radius: 999px;
      }
      #slides-root::-webkit-scrollbar-thumb {
        background: color-mix(
          in srgb,
          var(--tertiary-sage) 70%,
          var(--secondary-sage) 30%
        );
        border-radius: 999px;
      }
      .slide-status-bar {
        display: grid;
        gap: var(--space-3);
        padding: clamp(16px, 2.2vw, 24px);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: color-mix(in srgb, var(--soft-white) 94%, white 6%);
        box-shadow: var(--shadow-1);
        margin-top: var(--space-6);
      }
      .slide-status-bar__row {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: var(--space-3);
      }
      .slide-status-bar__count {
        margin: 0;
        font-weight: 700;
        font-size: var(--step-1);
        color: var(--forest-shadow);
      }
      .slide-status-bar__actions {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        flex-wrap: wrap;
      }
      .slide-status-bar__actions button {
        white-space: nowrap;
      }
      .slide-status-bar__actions .activity-btn {
        padding: 10px 16px;
        font-size: var(--step--1);
        font-weight: 700;
        min-height: 40px;
      }
      .slide-status-bar__progress {
        display: grid;
        gap: var(--space-3);
      }
      .slide-status-bar__progress-track {
        position: relative;
        width: 100%;
        height: 12px;
        background: rgba(122, 132, 113, 0.18);
        border-radius: 999px;
        overflow: hidden;
      }
      .slide-status-bar__progress-fill {
        position: absolute;
        inset: 0;
        width: var(--progress, 0%);
        background: linear-gradient(
          90deg,
          rgba(156, 175, 136, 0.85),
          rgba(122, 132, 113, 0.95)
        );
        border-radius: inherit;
        transition: width var(--dur-3) var(--ease-ambient);
      }
      .slide-status-bar__progress-label {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
        display: flex;
        justify-content: space-between;
      }
      #focus-mode-toggle[aria-pressed="false"] .focus-on-icon {
        display: inline-flex;
      }
      #focus-mode-toggle[aria-pressed="false"] .focus-off-icon {
        display: none;
      }
      #focus-mode-toggle[aria-pressed="true"] .focus-on-icon {
        display: none;
      }
      #focus-mode-toggle[aria-pressed="true"] .focus-off-icon {
        display: inline-flex;
      }
      @media (max-width: 720px) {
        .slide-status-bar__row {
          flex-direction: column;
          align-items: stretch;
        }
        .slide-status-bar__actions {
          justify-content: center;
        }
      }

      /* ------------------------------- Presentation shell ----------------------------------*/
      .presentation-header {
        position: sticky;
        top: 0;
        margin: 0 0 var(--space-4);
        padding: var(--space-2) 0;
        display: flex;
        justify-content: center;
        background: linear-gradient(180deg, rgba(248, 246, 240, 0.92), rgba(248, 246, 240, 0));
        z-index: 40;
        pointer-events: none;
      }
      .session-tools {
        position: relative;
        pointer-events: auto;
        width: min(160px, 42vw);
      }
      .session-tools__trigger {
        appearance: none;
        border: none;
        padding: 12px 0;
        width: 100%;
        background: none;
        cursor: pointer;
        position: relative;
      }
      .session-tools__trigger::before {
        content: '';
        display: block;
        width: 100%;
        height: 8px;
        border-radius: 999px;
        background: linear-gradient(90deg, rgba(122, 132, 113, 0.45), rgba(156, 175, 136, 0.65));
        box-shadow: 0 6px 18px rgba(47, 58, 43, 0.18);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient),
          background var(--dur-2) var(--ease-ambient);
      }
      .session-tools__trigger::after {
        content: '';
        position: absolute;
        inset: 12px 0;
        border-radius: 999px;
        background: linear-gradient(90deg, rgba(122, 132, 113, 0.75), rgba(156, 175, 136, 0.95));
        opacity: 0;
        transition: opacity var(--dur-2) var(--ease-ambient);
      }
      .session-tools__trigger:hover::before {
        transform: translateY(-1px);
        box-shadow: var(--shadow-2);
      }
      .session-tools__trigger:focus-visible::before {
        outline: none;
        box-shadow: var(--ring);
      }
      .session-tools[data-open='true'] .session-tools__trigger::after {
        opacity: 1;
      }
      .session-tools__panel {
        position: absolute;
        top: calc(100% + var(--space-2));
        left: 50%;
        transform: translateX(-50%);
        width: min(320px, 90vw);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.22);
        background: color-mix(in srgb, var(--soft-white) 96%, white 4%);
        box-shadow: var(--shadow-3);
        padding: clamp(18px, 3.2vw, 26px);
        display: grid;
        gap: var(--space-4);
        z-index: 50;
      }
      .session-tools__panel[hidden] {
        display: none;
      }
      .session-tools__header {
        display: flex;
        flex-direction: column;
        gap: var(--space-1);
        text-align: center;
      }
      .session-tools__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .session-tools__hint {
        margin: 0;
        font-size: var(--step--2);
        color: var(--ink-muted);
      }
      .session-tools__actions {
        display: grid;
        gap: var(--space-3);
      }
      .session-tools__status {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
        text-align: center;
      }
      .session-tools__status strong {
        color: var(--forest-shadow);
      }
      .session-tools__highlight {
        display: grid;
        gap: var(--space-3);
        text-align: left;
      }
      .session-tools__highlight-intro {
        display: grid;
        gap: var(--space-1);
      }
      .lesson-selector {
        display: grid;
        gap: var(--space-2);
      }
      .lesson-selector label {
        font-size: var(--step--1);
        color: var(--ink-muted);
        font-weight: 700;
      }
      .lesson-selector select {
        width: 100%;
        min-height: var(--target-min);
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.2);
        padding: var(--space-3);
        font: inherit;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: inset 0 1px 2px rgba(122, 132, 113, 0.1);
        transition:
          border-color var(--dur-1) var(--ease-ambient),
          box-shadow var(--dur-1) var(--ease-ambient);
      }
      .lesson-selector select:focus-visible {
        outline: none;
        border-color: var(--secondary-sage);
        box-shadow: var(--ring);
      }
      .text-input {
        width: 100%;
        min-height: var(--target-min);
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.2);
        padding: var(--space-3);
        font: inherit;
        background: rgba(255, 255, 255, 0.9);
        color: var(--forest-shadow);
        box-shadow: inset 0 1px 2px rgba(122, 132, 113, 0.1);
        transition:
          border-color var(--dur-1) var(--ease-ambient),
          box-shadow var(--dur-1) var(--ease-ambient);
      }
      .text-input:focus-visible {
        outline: none;
        border-color: var(--secondary-sage);
        box-shadow: var(--ring);
      }
      .response-grid {
        display: grid;
        gap: var(--space-4);
      }
      @media (min-width: 768px) {
        .response-grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .response-grid__field {
        display: grid;
        gap: var(--space-2);
      }
      .response-grid__label {
        font-weight: 700;
        color: var(--forest-shadow);
      }
      .response-grid__helper {
        margin: 0;
        font-size: var(--step--2);
        color: var(--ink-muted);
      }
      .annotation-tool {
        display: grid;
        gap: var(--space-3);
      }
      .annotation-tool__toggle {
        width: 100%;
        border: 1px solid rgba(142, 77, 255, 0.25);
        border-radius: var(--radius-lg);
        padding: var(--space-3) var(--space-4);
        background:
          linear-gradient(135deg, rgba(142, 77, 255, 0.16), rgba(142, 77, 255, 0.04));
        color: var(--deep-forest);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: var(--space-3);
        cursor: pointer;
        box-shadow: var(--shadow-1);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient),
          border-color var(--dur-2) var(--ease-ambient),
          background var(--dur-2) var(--ease-ambient);
      }
      .annotation-tool__toggle:hover {
        transform: translateY(-1px);
        box-shadow: var(--shadow-2);
      }
      .annotation-tool__toggle:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .annotation-tool__toggle-icon {
        display: grid;
        place-items: center;
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: rgba(142, 77, 255, 0.12);
        color: rgba(83, 36, 186, 0.85);
        font-size: 1.1rem;
      }
      .annotation-tool__toggle-copy {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
      .annotation-tool__toggle-title {
        font-size: var(--step--1);
        font-weight: 800;
        color: var(--forest-shadow);
        margin: 0;
      }
      .annotation-tool__toggle-subtitle {
        font-size: var(--step--2);
        color: var(--ink-muted);
        margin: 0;
      }
      .annotation-tool__state {
        font-size: var(--step--2);
        font-weight: 800;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--ink-muted);
      }
      .annotation-tool[data-active='true'] .annotation-tool__toggle {
        border-color: rgba(142, 77, 255, 0.55);
        background:
          linear-gradient(135deg, rgba(142, 77, 255, 0.22), rgba(142, 77, 255, 0.06));
      }
      .annotation-tool[data-active='true'] .annotation-tool__state {
        color: rgba(83, 36, 186, 0.85);
      }
      .annotation-tool__palette {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(142, 77, 255, 0.15);
        background: color-mix(in srgb, var(--soft-white) 97%, white 3%);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
        padding: var(--space-3) var(--space-4);
        display: grid;
        gap: var(--space-3);
      }
      .annotation-tool__palette[aria-hidden='true'] {
        display: none;
      }
      .annotation-tool__label {
        font-size: var(--step--2);
        font-weight: 800;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--forest-shadow);
      }
      .annotation-tool__hint {
        margin: 0;
        font-size: var(--step--2);
        color: var(--ink-muted);
      }
      .annotation-tool__swatches {
        display: flex;
        gap: var(--space-2);
        flex-wrap: wrap;
      }
      .annotation-tool__color {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border: 3px solid transparent;
        background:
          radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0) 60%),
          var(--swatch, rgba(142, 77, 255, 0.4));
        cursor: pointer;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          border-color var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient);
      }
      .annotation-tool__color:hover {
        transform: translateY(-2px);
      }
      .annotation-tool__color:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .annotation-tool__color.is-selected {
        border-color: rgba(142, 77, 255, 0.55);
        transform: translateY(-2px) scale(1.03);
      }
      .annotation-popover {
        position: fixed;
        max-width: min(320px, 88vw);
        z-index: 96;
        pointer-events: none;
        opacity: 0;
        transform: translateY(8px);
        transition: opacity var(--dur-2) var(--ease-ambient), transform var(--dur-2) var(--ease-ambient);
      }
      .annotation-popover.is-visible {
        pointer-events: auto;
        opacity: 1;
        transform: translateY(0);
      }
      .annotation-popover__inner {
        position: relative;
        padding: var(--space-4);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(142, 77, 255, 0.2);
        background: color-mix(in srgb, var(--soft-white) 96%, white 4%);
        box-shadow: var(--shadow-3);
        display: grid;
        gap: var(--space-3);
      }
      .annotation-popover__close {
        position: absolute;
        top: var(--space-2);
        right: var(--space-2);
        border: none;
        background: none;
        color: var(--ink-muted);
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        transition:
          background var(--dur-2) var(--ease-ambient),
          color var(--dur-2) var(--ease-ambient);
      }
      .annotation-popover__close:hover {
        background: rgba(142, 77, 255, 0.12);
        color: var(--deep-forest);
      }
      .annotation-popover__close:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .annotation-popover__label {
        font-size: var(--step--1);
        font-weight: 700;
        color: var(--forest-shadow);
        margin: 0;
      }
      .annotation-tool__textarea {
        min-height: 90px;
        border-radius: var(--radius-sm);
        border: 1px solid rgba(142, 77, 255, 0.28);
        padding: var(--space-3);
        font: inherit;
        background: rgba(255, 255, 255, 0.95);
        resize: vertical;
      }
      .annotation-tool__textarea:focus {
        outline: none;
        box-shadow: var(--ring);
      }
      .annotation-tool__actions {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
        justify-content: flex-end;
      }
      .annotation-tool__action {
        border: none;
        border-radius: var(--radius-sm);
        padding: var(--space-2) var(--space-4);
        font-weight: 700;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient),
          background var(--dur-2) var(--ease-ambient);
      }
      .annotation-tool__action.primary {
        background: linear-gradient(135deg, rgba(142, 77, 255, 0.18), rgba(142, 77, 255, 0.38));
        color: var(--deep-forest);
      }
      .annotation-tool__action.danger {
        background: rgba(255, 77, 109, 0.14);
        color: #8a1f3f;
        border: 1px solid rgba(255, 77, 109, 0.35);
      }
      .annotation-tool__action:hover {
        transform: translateY(-1px);
        box-shadow: var(--shadow-2);
      }
      .annotation-tool__action:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .annotation-tool__message {
        margin: 0;
        font-size: var(--step--2);
        color: #8a1f3f;
        display: none;
      }
      .annotation-tool__message.is-visible {
        display: block;
      }
      .lesson-overview__body {
        display: grid;
        gap: var(--space-4);
        margin: 0;
      }
      .lesson-overview__section {
        display: grid;
        gap: var(--space-2);
      }
      .lesson-overview__section-title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 700;
        color: var(--forest-shadow);
      }
      .lesson-overview__list {
        margin: 0;
        padding-left: 1.1em;
        display: grid;
        gap: var(--space-1);
      }
      .lesson-overview__callout {
        margin: 0;
        padding: var(--space-3);
        border-left: 4px solid var(--secondary-sage);
        background: rgba(156, 175, 136, 0.1);
        border-radius: var(--radius-sm);
        font-size: var(--step--1);
        color: var(--forest-shadow);
      }
      @media (min-width: 768px) {
        .lesson-overview__body {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      #slide-map {
        margin: 0;
      }
      #slide-map-list {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
        margin: 0;
        padding: 0;
        list-style: none;
      }
      .slide-map-group {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
      }
      .slide-map-group__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
        letter-spacing: 0.3px;
      }
      .slide-map-group__list {
        display: grid;
        gap: var(--space-2);
        margin: 0;
        padding: 0;
        list-style: none;
      }
      @container (min-width: 720px) {
        .slide-map-group__list {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .slide-map-item {
        min-width: 0;
      }
      .slide-map-button {
        border: 1px solid rgba(122, 132, 113, 0.25);
        background: rgba(255, 255, 255, 0.88);
        border-radius: var(--radius-sm);
        padding: var(--space-3);
        font-size: var(--step--1);
        font-weight: 600;
        color: var(--forest-shadow);
        cursor: pointer;
        display: grid;
        grid-template-columns: auto 1fr;
        align-items: center;
        gap: var(--space-3);
        width: 100%;
        min-height: var(--target-min);
        transition:
          transform var(--dur-1) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient),
          border-color var(--dur-2) var(--ease-ambient),
          background var(--dur-2) var(--ease-ambient);
        white-space: normal;
        overflow-wrap: anywhere;
        text-align: left;
      }
      .slide-map-button:hover,
      .slide-map-button:focus-visible {
        outline: none;
        transform: translateY(-1px);
        border-color: var(--secondary-sage);
        box-shadow: 0 6px 12px rgba(62, 74, 58, 0.15);
        background: color-mix(in srgb, var(--soft-white) 94%, white 6%);
      }
      .slide-map-item.is-active .slide-map-button {
        background: linear-gradient(
          180deg,
          color-mix(in srgb, var(--secondary-sage) 92%, white 8%),
          var(--secondary-sage)
        );
        color: var(--soft-white);
        border-color: var(--secondary-sage);
        box-shadow: 0 6px 12px rgba(62, 74, 58, 0.18);
      }
      .slide-map-item.is-active .slide-map-button:hover,
      .slide-map-item.is-active .slide-map-button:focus-visible {
        transform: translateY(-1px);
      }
      .slide-map-button__number {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 999px;
        background: color-mix(in srgb, var(--secondary-sage) 25%, white 75%);
        color: var(--forest-shadow);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 0.95rem;
        letter-spacing: 0.3px;
      }
      .slide-map-button__label {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .slide-map-button__title {
        font-size: var(--step--1);
        font-weight: 700;
        color: inherit;
      }
      .slide-map-button__subtitle {
        font-size: 0.85rem;
        color: var(--ink-muted);
      }
      .slide-map-item.is-active .slide-map-button__number {
        background: color-mix(
          in srgb,
          var(--soft-white) 20%,
          var(--forest-shadow) 80%
        );
        color: var(--soft-white);
      }

      /* ------------------------------- Buttons ----------------------------------*/
      .activity-btn {
        min-height: var(--target-min);
        padding: 12px 20px;
        border-radius: 12px;
        border: 1px solid var(--primary-sage);
        background: linear-gradient(
          180deg,
          color-mix(in srgb, var(--primary-sage) 92%, white 8%),
          var(--primary-sage)
        );
        color: #fff;
        font-weight: 700;
        font-size: 1rem;
        letter-spacing: 0.2px;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
        user-select: none;
        transition:
          transform var(--dur-1) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient),
          background var(--dur-2) var(--ease-ambient),
          border-color var(--dur-2) var(--ease-ambient),
          opacity var(--dur-1) var(--ease-ambient);
        box-shadow:
          0 1px 0 rgba(255, 255, 255, 0.25) inset,
          0 8px 16px rgba(90, 107, 82, 0.2);
      }
      .activity-btn:hover {
        background: linear-gradient(
          180deg,
          color-mix(in srgb, var(--forest-shadow) 92%, white 8%),
          var(--forest-shadow)
        );
        transform: translateY(-1px);
        box-shadow:
          0 1px 0 rgba(255, 255, 255, 0.25) inset,
          0 10px 20px rgba(90, 107, 82, 0.22);
      }
      .activity-btn:active {
        transform: translateY(0);
        box-shadow:
          0 1px 0 rgba(255, 255, 255, 0.2) inset,
          0 4px 10px rgba(90, 107, 82, 0.2);
      }
      .activity-btn:focus-visible {
        outline: none;
        box-shadow:
          var(--ring),
          0 8px 16px rgba(90, 107, 82, 0.2);
      }
      .activity-btn:disabled,
      .activity-btn[disabled] {
        background: var(--tertiary-sage);
        border-color: var(--tertiary-sage);
        color: color-mix(in srgb, #fff 70%, var(--soft-white) 30%);
        cursor: not-allowed;
        opacity: 0.8;
        transform: none;
        box-shadow: none;
      }
      .activity-btn.secondary {
        background: transparent;
        color: var(--primary-sage);
        border-color: color-mix(
          in srgb,
          var(--tertiary-sage) 70%,
          var(--primary-sage) 30%
        );
        box-shadow: none;
      }
      .activity-btn.is-active {
        background: color-mix(in srgb, var(--secondary-sage) 85%, white 15%);
        color: var(--soft-white);
        border-color: var(--secondary-sage);
        box-shadow: var(--shadow-2);
      }
      .activity-btn.is-active:hover {
        background: color-mix(in srgb, var(--secondary-sage) 70%, white 30%);
      }
      .activity-btn.secondary:hover {
        background-color: var(--hover-sage);
      }
      .activity-btn.secondary:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .controls {
        margin-top: var(--space-7);
        text-align: center;
        display: grid;
        gap: var(--space-3);
        grid-auto-flow: row;
      }
      .controls .activity-btn {
        justify-self: center;
        padding-inline: clamp(24px, 3vw, 36px);
      }
      .controls__hint {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
      }
      .controls__hint strong {
        color: var(--forest-shadow);
      }
      .activity-actions {
        display: grid;
        gap: var(--space-3);
        justify-items: center;
        margin-top: var(--space-6);
      }
      .activity-actions .activity-btn {
        width: min(100%, 260px);
      }
      .activity-actions__hint {
        font-size: var(--step--1);
        color: var(--ink-muted);
        margin: 0;
      }

      /* ------------------------------- Slide content wrappers ----------------------------------*/
      .slide {
        display: none;
        position: relative;
      }
      .slide.active {
        display: grid;
        gap: clamp(24px, 4vw, 48px);
      }
      @media (min-width: 1024px) {
        .slide.active {
          grid-template-columns: minmax(0, 3fr) minmax(260px, 1fr);
          align-items: start;
        }
      }
      .slide-content {
        display: grid;
        gap: var(--space-5);
        background: rgba(255, 255, 255, 0.82);
        border-radius: var(--radius-lg);
        padding: clamp(28px, 4vw, 42px);
        border: 1px solid rgba(122, 132, 113, 0.12);
        box-shadow: var(--shadow-2);
      }
      .slide-content--centered {
        place-items: center;
        text-align: center;
      }
      .slide-content--centered > * {
        max-width: min(640px, 82%);
      }
      @media (min-width: 1024px) {
        .slide-content {
          grid-column: 1 / 2;
        }
      }
      .slide-annotations {
        display: grid;
        gap: var(--space-3);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.16);
        background: color-mix(in srgb, var(--soft-white) 92%, white 8%);
        padding: clamp(22px, 3.5vw, 32px);
        box-shadow: var(--shadow-1);
      }
      @media (min-width: 1024px) {
        .slide-annotations {
          grid-column: 2 / 3;
          position: sticky;
          top: clamp(90px, 14vh, 140px);
          align-self: start;
        }
      }
      .slide-annotations__header {
        display: grid;
        gap: var(--space-1);
      }
      .slide-annotations__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .slide-annotations__intro {
        margin: 0;
        font-size: var(--step--2);
        color: var(--ink-muted);
      }
      .slide-annotations__list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: var(--space-3);
      }
      .slide-annotations__empty {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
      }
      .slide-annotation {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: var(--space-3);
        align-items: start;
        padding: var(--space-3);
        border-radius: var(--radius-sm);
        background: color-mix(in srgb, var(--warm-cream) 65%, white 35%);
        border: 1px solid rgba(122, 132, 113, 0.16);
        cursor: pointer;
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient);
      }
      .slide-annotation:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-2);
      }
      .slide-annotation:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }
      .slide-annotation__color {
        width: 12px;
        border-radius: 999px;
        background: var(--annotation-color, rgba(142, 77, 255, 0.5));
        height: 100%;
        display: block;
      }
      .slide-annotation__text {
        margin: 0;
        font-size: var(--step--1);
        color: var(--forest-shadow);
      }
      .slide-content.layout--poster {
        position: relative;
        overflow: hidden;
      }
      .slide-content.layout--poster::before {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(
          320px 220px at 20% 15%,
          rgba(198, 170, 119, 0.28),
          transparent 70%
        );
        opacity: 0.75;
        pointer-events: none;
      }
      .slide-content.layout--columns {
        display: grid;
        gap: clamp(24px, 3vw, 36px);
        align-items: start;
      }
      @media (min-width: 1024px) {
        .slide-content.layout--columns {
          grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
        }
      }
      .layout-grid {
        display: grid;
        gap: clamp(24px, 3vw, 36px);
      }
      @media (min-width: 1024px) {
        .layout-grid {
          grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
          align-items: start;
        }
        .layout-grid__column {
          display: grid;
          gap: clamp(20px, 3vw, 32px);
        }
      }

      /* ------------------------------- Slide typography & badges ----------------------------------*/
      .slide-title {
        font-family: var(--font-display);
        font-size: clamp(1.75rem, 2.4vw, 2.4rem);
        color: var(--forest-shadow);
        display: inline-flex;
        align-items: center;
        gap: var(--space-3);
        margin: 0;
      }
      .slide-title i {
        font-size: 1.3em;
        color: var(--secondary-sage);
      }
      .section-eyebrow {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        font-size: var(--step--1);
        font-weight: 700;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: rgba(47, 58, 43, 0.65);
      }
      .section-eyebrow::before {
        content: "";
        width: 24px;
        height: 2px;
        background: rgba(47, 58, 43, 0.35);
      }
      .session-summary__title {
        font-family: var(--font-display);
        font-size: clamp(1.5rem, 2vw, 1.9rem);
        margin: 0;
        color: var(--forest-shadow);
      }
      .session-summary__subtitle {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
      }
      .session-summary__intro {
        display: grid;
        gap: var(--space-3);
        padding: var(--space-4);
        border-radius: var(--radius-lg);
        background: color-mix(
          in srgb,
          rgba(156, 175, 136, 0.18) 65%,
          rgba(255, 246, 233, 0.4) 35%
        );
        border: 1px solid rgba(156, 175, 136, 0.32);
      }
      .session-summary__highlights {
        display: grid;
        gap: var(--space-3);
      }
      .highlight-tag {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: 0.35em 0.9em;
        border-radius: 999px;
        background: rgba(122, 132, 113, 0.18);
        color: var(--forest-shadow);
        font-size: var(--step--1);
        font-weight: 700;
      }
      .highlight-tag i {
        font-size: 0.9em;
      }

      /* ------------------------------- Pedagogy cards ----------------------------------*/
      .session-pedagogy__grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      @media (min-width: 768px) {
        .session-pedagogy__grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .pedagogy-card {
        border-radius: var(--radius-lg);
        background: rgba(255, 255, 255, 0.75);
        border: 1px solid rgba(122, 132, 113, 0.12);
        padding: clamp(20px, 2.6vw, 28px);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-1);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient);
      }
      .pedagogy-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-2);
      }
      .pedagogy-card__header {
        display: inline-flex;
        align-items: center;
        gap: var(--space-3);
      }
      .pedagogy-card__icon {
        width: 52px;
        height: 52px;
        border-radius: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          135deg,
          rgba(156, 175, 136, 0.22),
          rgba(255, 246, 233, 0.55)
        );
        color: var(--forest-shadow);
        font-size: 1.4rem;
      }
      .pedagogy-card__title {
        margin: 0;
        font-size: var(--step-1);
        color: var(--forest-shadow);
      }
      .pedagogy-card p {
        margin: 0;
        color: var(--ink-muted);
      }

      /* ------------------------------- Guide cards ----------------------------------*/
      .session-guide__grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      @media (min-width: 768px) {
        .session-guide__grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .guide-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.15);
        padding: clamp(20px, 2.6vw, 28px);
        background: color-mix(
          in srgb,
          rgba(255, 246, 233, 0.8) 65%,
          rgba(156, 175, 136, 0.35) 35%
        );
        box-shadow: var(--shadow-1);
        display: grid;
        gap: var(--space-3);
      }
      .guide-card h3 {
        margin: 0;
        font-size: var(--step-1);
        color: var(--forest-shadow);
        display: inline-flex;
        align-items: center;
        gap: var(--space-3);
      }
      .guide-card h3 i {
        font-size: 1.2em;
        color: var(--secondary-sage);
      }
      .guide-card p {
        margin: 0;
        color: var(--ink-muted);
      }

      /* ------------------------------- Session grounding ----------------------------------*/
      .session-grounding {
        display: grid;
        gap: var(--space-3);
      }
      .grounding-slide {
        position: relative;
        display: grid;
        overflow: hidden;
        border-radius: var(--radius-xl);
        min-height: clamp(280px, 50vw, 420px);
      }
      .grounding-slide img {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: saturate(0.92) brightness(0.95);
      }
      .grounding-overlay {
        position: relative;
        z-index: 1;
        display: grid;
        gap: var(--space-3);
        padding: clamp(24px, 5vw, 40px);
        background: linear-gradient(
          140deg,
          rgba(47, 58, 43, 0.85),
          rgba(47, 58, 43, 0.55)
        );
        color: rgba(255, 255, 255, 0.95);
      }
      .grounding-overlay .text-lg {
        margin: 0;
        color: rgba(255, 255, 255, 0.92);
      }
      .grounding-overlay h3 {
        margin: 0;
        font-size: clamp(1.5rem, 2.2vw, 2rem);
        color: #fff;
      }
      .grounding-prompts {
        margin: 0;
        padding-left: 1.2em;
        display: grid;
        gap: var(--space-2);
      }
      .grounding-prompts li {
        line-height: 1.6;
      }
      .grounding-prompts i {
        color: rgba(255, 255, 255, 0.85);
        margin-right: 0.5em;
      }
      .grounding-overlay .text-sm {
        color: rgba(255, 255, 255, 0.7);
        margin: 0;
      }

      /* ------------------------------- Question prompts ----------------------------------*/
      .question-prompts {
        display: grid;
        gap: var(--space-4);
      }
      @media (min-width: 768px) {
        .question-prompts {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .question-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        padding: clamp(20px, 2.8vw, 28px);
        background: color-mix(
          in srgb,
          rgba(255, 246, 233, 0.85) 55%,
          rgba(156, 175, 136, 0.22) 45%
        );
        box-shadow: var(--shadow-1);
        display: grid;
        gap: var(--space-2);
      }
      .question-card h4 {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        color: var(--forest-shadow);
      }
      .question-card h4 i {
        font-size: 1.1em;
        color: var(--secondary-sage);
      }
      .question-card p {
        margin: 0;
        color: var(--ink-muted);
      }

      /* ------------------------------- Session overview image ----------------------------------*/
      figure {
        margin: 0;
      }
      figure img {
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-3);
        overflow: hidden;
      }
      figure figcaption {
        margin-top: var(--space-2);
        font-size: var(--step--2);
        color: var(--ink-muted);
        text-align: center;
      }
      figure a {
        color: var(--secondary-sage);
      }

      /* ------------------------------- Slide layout utilities ----------------------------------*/
      .slide-section {
        display: grid;
        gap: clamp(24px, 3vw, 36px);
      }
      .section-intro {
        display: grid;
        gap: var(--space-2);
      }
      .section-intro__title {
        margin: 0;
        font-family: var(--font-display);
        font-size: clamp(1.6rem, 2.2vw, 2rem);
        color: var(--forest-shadow);
      }
      .section-intro__descriptor {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step-0);
      }
      .section-intro__eyebrow {
        margin: 0;
        font-size: var(--step--1);
        font-weight: 700;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: rgba(47, 58, 43, 0.65);
      }
      .checklist {
        display: grid;
        gap: var(--space-3);
        padding: 0;
        margin: 0;
        list-style: none;
      }
      .checklist-item {
        position: relative;
        padding-left: clamp(36px, 4vw, 42px);
        font-size: var(--step-0);
        color: var(--forest-shadow);
      }
      .checklist-item::before {
        content: "\f00c";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        left: 0;
        top: 0.1em;
        color: var(--secondary-sage);
      }
      .callout-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: color-mix(in srgb, var(--soft-white) 90%, white 10%);
        padding: clamp(20px, 3vw, 32px);
        box-shadow: var(--shadow-2);
        display: grid;
        gap: var(--space-3);
      }
      .callout-card__title {
        margin: 0;
        font-size: var(--step-1);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .callout-card__body {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step-0);
      }
      .callout-card__footer {
        margin: 0;
        font-size: var(--step--1);
        color: rgba(47, 58, 43, 0.6);
      }
      .callout-card__footer i {
        color: var(--secondary-sage);
        margin-right: 0.5em;
      }
      .inline-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--space-1);
        padding: 0.3em 0.8em;
        border-radius: 999px;
        background: rgba(122, 132, 113, 0.16);
        font-size: var(--step--1);
        font-weight: 700;
        color: var(--forest-shadow);
      }
      .inline-badge i {
        color: var(--secondary-sage);
      }

      /* ------------------------------- Timeline / agenda ----------------------------------*/
      .agenda {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      .agenda__item {
        display: grid;
        gap: var(--space-2);
        border-left: 4px solid rgba(122, 132, 113, 0.32);
        padding-left: var(--space-4);
      }
      .agenda__item.is-active {
        border-color: var(--secondary-sage);
      }
      .agenda__time {
        margin: 0;
        font-size: var(--step--1);
        font-weight: 700;
        color: var(--ink-muted);
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }
      .agenda__title {
        margin: 0;
        font-size: var(--step-1);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .agenda__descriptor {
        margin: 0;
        font-size: var(--step-0);
        color: var(--ink-muted);
      }
      .agenda__actions {
        display: inline-flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }
      .agenda__action {
        display: inline-flex;
        align-items: center;
        gap: var(--space-1);
        font-size: var(--step--1);
        padding: 0.2em 0.6em;
        border-radius: 999px;
        background: rgba(156, 175, 136, 0.18);
        color: var(--forest-shadow);
        font-weight: 700;
      }

      /* ------------------------------- Graphic prompts ----------------------------------*/
      .prompt-tiles {
        display: grid;
        gap: clamp(16px, 2.4vw, 24px);
      }
      @media (min-width: 600px) {
        .prompt-tiles {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .prompt-tile {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.15);
        padding: clamp(20px, 2.6vw, 28px);
        background: rgba(255, 255, 255, 0.85);
        box-shadow: var(--shadow-1);
        display: grid;
        gap: var(--space-3);
      }
      .prompt-tile__icon {
        width: 48px;
        height: 48px;
        border-radius: 14px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: color-mix(
          in srgb,
          rgba(156, 175, 136, 0.35) 60%,
          rgba(255, 246, 233, 0.6) 40%
        );
        color: var(--forest-shadow);
        font-size: 1.3rem;
      }
      .prompt-tile__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .prompt-tile__body {
        margin: 0;
        color: var(--ink-muted);
      }

      /* ------------------------------- Reflection prompts ----------------------------------*/
      .reflection-grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      @media (min-width: 768px) {
        .reflection-grid {
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }
      }
      .reflection-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.2);
        padding: clamp(20px, 2.6vw, 28px);
        display: grid;
        gap: var(--space-3);
        background: rgba(255, 255, 255, 0.8);
        box-shadow: var(--shadow-1);
      }
      .reflection-card__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .reflection-card__body {
        margin: 0;
        color: var(--ink-muted);
      }

      /* ------------------------------- Note-taking utilities ----------------------------------*/
      .note-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.2);
        background: rgba(255, 255, 255, 0.9);
        box-shadow: var(--shadow-1);
        padding: clamp(20px, 3vw, 32px);
        display: grid;
        gap: var(--space-3);
      }
      .note-card__header {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        color: var(--forest-shadow);
        font-size: var(--step-0);
        font-weight: 800;
      }
      .note-card__header i {
        color: var(--secondary-sage);
      }
      .note-card__body {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step--1);
      }
      .note-card__footer {
        display: inline-flex;
        gap: var(--space-2);
        align-items: center;
      }
      .note-card__footer .inline-badge {
        background: rgba(156, 175, 136, 0.15);
      }
      .note-card textarea {
        width: 100%;
        min-height: 160px;
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.22);
        padding: var(--space-3);
        font: inherit;
        background: rgba(255, 255, 255, 0.92);
        color: var(--forest-shadow);
        resize: vertical;
        transition:
          border-color var(--dur-1) var(--ease-ambient),
          box-shadow var(--dur-1) var(--ease-ambient);
      }
      .note-card textarea:focus-visible {
        outline: none;
        border-color: var(--secondary-sage);
        box-shadow: var(--ring);
      }

      /* ------------------------------- Table styling ----------------------------------*/
      table {
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
        border: 1px solid rgba(122, 132, 113, 0.2);
        border-radius: var(--radius-lg);
        overflow: hidden;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: var(--shadow-1);
      }
      thead {
        background: color-mix(in srgb, var(--secondary-sage) 25%, white 75%);
        color: var(--forest-shadow);
      }
      th,
      td {
        padding: clamp(12px, 1.5vw, 18px);
        text-align: left;
        font-size: var(--step--1);
        color: var(--forest-shadow);
        border-bottom: 1px solid rgba(122, 132, 113, 0.15);
      }
      th {
        font-weight: 800;
        font-size: var(--step-0);
      }
      tbody tr:nth-child(odd) {
        background: rgba(122, 132, 113, 0.06);
      }
      tbody tr:hover {
        background: rgba(156, 175, 136, 0.12);
      }
      caption {
        caption-side: bottom;
        padding: var(--space-3);
        font-size: var(--step--2);
        color: var(--ink-muted);
        text-align: left;
      }

      /* ------------------------------- Check-in modules ----------------------------------*/
      .check-in-grid {
        display: grid;
        gap: clamp(16px, 2.4vw, 24px);
      }
      @media (min-width: 768px) {
        .check-in-grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .check-in-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.16);
        padding: clamp(20px, 2.6vw, 28px);
        background: rgba(255, 255, 255, 0.85);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-1);
      }
      .check-in-card__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .check-in-card__body {
        margin: 0;
        color: var(--ink-muted);
      }
      .emoji-row {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        font-size: 1.4rem;
      }

      /* ------------------------------- Activity tiles ----------------------------------*/
      .activity-grid {
        display: grid;
        gap: clamp(20px, 3vw, 30px);
      }
      @media (min-width: 768px) {
        .activity-grid {
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }
      }
      .activity-tile {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.16);
        background: rgba(255, 255, 255, 0.9);
        padding: clamp(20px, 3vw, 32px);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-2);
        transition:
          transform var(--dur-2) var(--ease-ambient),
          box-shadow var(--dur-2) var(--ease-ambient);
      }
      .activity-tile:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-3);
      }
      .activity-tile__title {
        margin: 0;
        font-size: var(--step-1);
        font-weight: 800;
        color: var(--forest-shadow);
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
      }
      .activity-tile__title i {
        color: var(--secondary-sage);
      }
      .activity-tile__descriptor {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step-0);
      }
      .activity-tile__meta {
        display: inline-flex;
        flex-wrap: wrap;
        gap: var(--space-2);
        font-size: var(--step--2);
        color: rgba(47, 58, 43, 0.65);
      }
      .activity-tile__meta span {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 0.2em 0.6em;
        border-radius: 999px;
        background: rgba(156, 175, 136, 0.18);
        font-weight: 700;
      }

      /* ------------------------------- Poll modules ----------------------------------*/
      .poll-grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      .poll-question {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .poll-options {
        display: grid;
        gap: var(--space-2);
      }
      .poll-option {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-3);
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: rgba(255, 255, 255, 0.85);
        box-shadow: inset 0 1px 2px rgba(122, 132, 113, 0.08);
        font-size: var(--step--1);
        color: var(--forest-shadow);
      }
      .poll-option i {
        color: var(--secondary-sage);
      }

      /* ------------------------------- Story cards ----------------------------------*/
      .story-grid {
        display: grid;
        gap: clamp(24px, 3vw, 36px);
      }
      @media (min-width: 768px) {
        .story-grid {
          grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        }
      }
      .story-card {
        border-radius: var(--radius-xl);
        overflow: hidden;
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(122, 132, 113, 0.18);
        box-shadow: var(--shadow-2);
        display: grid;
        grid-template-rows: 220px 1fr;
      }
      .story-card__image {
        background-size: cover;
        background-position: center;
      }
      .story-card__body {
        padding: clamp(20px, 3vw, 30px);
        display: grid;
        gap: var(--space-2);
      }
      .story-card__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .story-card__subtitle {
        margin: 0;
        font-size: var(--step--1);
        color: var(--ink-muted);
      }
      .story-card__quote {
        margin: 0;
        font-style: italic;
        color: var(--forest-shadow);
      }

      /* ------------------------------- Interactive activities ----------------------------------*/
      .interactive-module {
        display: grid;
        gap: clamp(24px, 3vw, 36px);
      }
      .interactive-module__header {
        display: grid;
        gap: var(--space-2);
      }
      .interactive-module__title {
        margin: 0;
        font-size: clamp(1.6rem, 2.2vw, 2rem);
        font-family: var(--font-display);
        color: var(--forest-shadow);
      }
      .interactive-module__descriptor {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step-0);
      }
      .interactive-module__steps {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      .interactive-step {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: rgba(255, 255, 255, 0.85);
        padding: clamp(20px, 2.8vw, 32px);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-1);
      }
      .interactive-step__eyebrow {
        margin: 0;
        font-size: var(--step--2);
        font-weight: 800;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: rgba(47, 58, 43, 0.65);
      }
      .interactive-step__title {
        margin: 0;
        font-size: var(--step-1);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .interactive-step__body {
        margin: 0;
        color: var(--ink-muted);
      }
      .interactive-step__meta {
        display: inline-flex;
        gap: var(--space-2);
        font-size: var(--step--1);
        color: rgba(47, 58, 43, 0.6);
      }
      .interactive-step__meta span {
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }
      .interactive-step__meta i {
        color: var(--secondary-sage);
      }

      /* ------------------------------- Breakout prompts ----------------------------------*/
      .breakout-grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      @media (min-width: 768px) {
        .breakout-grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .breakout-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.2);
        background: rgba(255, 255, 255, 0.85);
        padding: clamp(20px, 2.6vw, 28px);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-1);
      }
      .breakout-card__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
      }
      .breakout-card__body {
        margin: 0;
        color: var(--ink-muted);
      }
      .breakout-card__footer {
        margin: 0;
        font-size: var(--step--2);
        color: rgba(47, 58, 43, 0.6);
        text-transform: uppercase;
        letter-spacing: 0.12em;
        font-weight: 700;
      }

      /* ------------------------------- Data table slides ----------------------------------*/
      .data-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        border: 1px solid rgba(122, 132, 113, 0.18);
        border-radius: var(--radius-lg);
        overflow: hidden;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: var(--shadow-2);
      }
      .data-table thead {
        background: color-mix(in srgb, var(--secondary-sage) 20%, white 80%);
        color: var(--forest-shadow);
      }
      .data-table th,
      .data-table td {
        padding: clamp(12px, 1.6vw, 18px);
        font-size: var(--step--1);
        color: var(--forest-shadow);
        border-bottom: 1px solid rgba(122, 132, 113, 0.12);
      }
      .data-table th {
        font-weight: 800;
        font-size: var(--step-0);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }
      .data-table tbody tr:nth-child(odd) {
        background: rgba(122, 132, 113, 0.06);
      }
      .data-table tbody tr:hover {
        background: rgba(156, 175, 136, 0.14);
      }
      .data-table__rating {
        text-align: center;
        width: clamp(110px, 12vw, 160px);
      }
      .data-table__choice {
        inline-size: 1.15rem;
        block-size: 1.15rem;
        accent-color: var(--secondary-sage);
      }

      /* ------------------------------- Chat prompts ----------------------------------*/
      .chat-prompts {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      .chat-message {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: rgba(255, 255, 255, 0.85);
        padding: clamp(18px, 2.5vw, 26px);
        display: grid;
        gap: var(--space-2);
        box-shadow: var(--shadow-1);
      }
      .chat-message__sender {
        margin: 0;
        font-size: var(--step--1);
        font-weight: 800;
        color: var(--forest-shadow);
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }
      .chat-message__body {
        margin: 0;
        color: var(--ink-muted);
        font-size: var(--step-0);
      }

      /* ------------------------------- Resource cards ----------------------------------*/
      .resource-grid {
        display: grid;
        gap: clamp(20px, 3vw, 28px);
      }
      @media (min-width: 768px) {
        .resource-grid {
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }
      }
      .resource-card {
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: rgba(255, 255, 255, 0.88);
        padding: clamp(20px, 2.8vw, 28px);
        display: grid;
        gap: var(--space-3);
        box-shadow: var(--shadow-1);
      }
      .resource-card__title {
        margin: 0;
        font-size: var(--step-0);
        font-weight: 800;
        color: var(--forest-shadow);
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
      }
      .resource-card__title i {
        color: var(--secondary-sage);
      }
      .resource-card__body {
        margin: 0;
        color: var(--ink-muted);
      }
      .resource-card__link {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        font-weight: 700;
        color: var(--primary-sage);
        text-decoration: none;
      }
      .resource-card__link:hover {
        text-decoration: underline;
      }
      
      /* --- Qualitative research deck custom styles --- */
      .welcome-card {
        display: grid;
        gap: var(--space-3);
        padding: clamp(28px, 5vw, 48px);
        border-radius: var(--radius-xl);
        background: linear-gradient(145deg, rgba(248, 246, 240, 0.95), rgba(156, 175, 136, 0.25));
        box-shadow: var(--shadow-3);
        border: 1px solid rgba(122, 132, 113, 0.2);
        align-items: center;
      }
      .welcome-card__icon {
        font-size: clamp(2.4rem, 4vw, 3.2rem);
        color: var(--secondary-sage);
      }
      .welcome-card__title {
        margin: 0;
        font-family: var(--font-display);
        font-size: clamp(2.6rem, 3.4vw, 3.6rem);
        color: var(--deep-forest);
      }
      .welcome-card__body {
        margin: 0;
        font-size: var(--step-1);
        color: color-mix(in srgb, var(--deep-forest) 70%, white 30%);
      }

      .full-image-slide {
        position: relative;
        min-height: min(70vh, 640px);
        border-radius: var(--radius-xl);
        overflow: hidden;
        display: grid;
      }
      .full-image-slide::before {
        content: "";
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        background-image: var(--slide-background);
        filter: brightness(0.8);
        transform: scale(1.02);
      }
      .full-image-slide__overlay {
        position: relative;
        inset: 0;
        display: grid;
        place-items: center;
        padding: clamp(28px, 5vw, 60px);
        background: linear-gradient(145deg, rgba(46, 53, 42, 0.55), rgba(46, 53, 42, 0.25));
      }
      .grounding-card,
      .closing-card {
        display: grid;
        gap: var(--space-3);
        padding: clamp(26px, 4vw, 42px);
        border-radius: var(--radius-xl);
        background: rgba(254, 252, 247, 0.85);
        box-shadow: var(--shadow-2);
        text-align: center;
        color: var(--deep-forest);
      }
      .grounding-card__line {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        font-size: clamp(1.1rem, 1.4vw, 1.4rem);
        font-weight: 600;
      }
      .grounding-card__line i {
        color: var(--secondary-sage);
        font-size: 1.5em;
      }
      .closing-card__icon {
        font-size: clamp(2.6rem, 4vw, 3.4rem);
        color: var(--secondary-sage);
      }
      .closing-card__title {
        margin: 0;
        font-family: var(--font-display);
        font-size: clamp(2.2rem, 3vw, 3.2rem);
      }
      .closing-card__body {
        margin: 0;
        font-size: var(--step-1);
        color: var(--forest-shadow);
      }

      .participant-table-wrapper {
        overflow-x: auto;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-1);
      }
      .participant-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 640px;
        background: rgba(255, 255, 255, 0.9);
      }
      .participant-table th,
      .participant-table td {
        padding: var(--space-3) var(--space-4);
        border: 1px solid rgba(122, 132, 113, 0.16);
        text-align: left;
      }
      .participant-table th {
        font-size: var(--step-1);
        color: var(--deep-forest);
        background: color-mix(in srgb, var(--warm-cream) 75%, white 25%);
      }
      .participant-table input {
        width: 100%;
        padding: var(--space-2) var(--space-3);
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.35);
        font-size: var(--step-0);
        font-family: var(--font-body);
        background: rgba(255, 255, 255, 0.9);
      }
      .participant-table input:focus {
        outline: none;
        box-shadow: var(--ring);
        border-color: var(--secondary-sage);
      }

      .curiosity-carousel {
        position: relative;
        display: grid;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: var(--space-4);
      }
      .carousel-viewport {
        overflow: hidden;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-2);
        background: rgba(255, 255, 255, 0.85);
        max-width: clamp(280px, 70vw, 640px);
        margin: 0 auto;
      }
      .carousel-track {
        display: flex;
        gap: 0;
        transition: transform var(--dur-3) var(--ease-ambient);
      }
      .curiosity-slide {
        flex: 0 0 100%;
        max-width: 100%;
        display: grid;
        gap: var(--space-3);
        padding: var(--space-4);
        background: rgba(255, 255, 255, 0.85);
      }
      .curiosity-slide img {
        width: 100%;
        aspect-ratio: 4 / 3;
        object-fit: cover;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-1);
      }
      .curiosity-slide figcaption {
        margin: 0;
        font-weight: 600;
        color: var(--deep-forest);
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }
      .carousel-control {
        width: var(--target-min);
        height: var(--target-min);
        border-radius: 50%;
        border: none;
        background: color-mix(in srgb, var(--secondary-sage) 70%, white 30%);
        color: white;
        font-size: 1.1rem;
        display: grid;
        place-items: center;
        box-shadow: var(--shadow-2);
        cursor: pointer;
        transition: transform var(--dur-1) var(--ease-ambient), box-shadow var(--dur-1) var(--ease-ambient);
      }
      .carousel-control:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-3);
      }
      .carousel-control:disabled {
        opacity: 0.35;
        cursor: not-allowed;
        transform: none;
        box-shadow: var(--shadow-1);
      }
      .carousel-dots {
        grid-column: 1 / -1;
        display: flex;
        justify-content: center;
        gap: var(--space-2);
        margin-top: var(--space-3);
      }
      .carousel-dots button {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: none;
        background: rgba(122, 132, 113, 0.3);
        cursor: pointer;
        transition: background var(--dur-1) var(--ease-ambient), transform var(--dur-1) var(--ease-ambient);
      }
      .carousel-dots button[aria-current="true"] {
        background: var(--secondary-sage);
        transform: scale(1.2);
      }

      .speech-bubbles {
        display: grid;
        gap: var(--space-4);
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
      .speech-bubble {
        position: relative;
        display: grid;
        gap: var(--space-3);
        padding: clamp(18px, 3vw, 26px);
        border-radius: var(--radius-lg);
        background: linear-gradient(160deg, rgba(248, 246, 240, 0.95), rgba(156, 175, 136, 0.2));
        border: 1px solid rgba(122, 132, 113, 0.2);
        box-shadow: var(--shadow-1);
      }
      .speech-bubble::after {
        content: "";
        position: absolute;
        bottom: -12px;
        left: clamp(32px, 20%, 80px);
        width: 24px;
        height: 24px;
        background: inherit;
        border: inherit;
        border-radius: 4px;
        transform: rotate(45deg);
      }
      .speech-bubble i {
        font-size: 1.4rem;
        color: var(--secondary-sage);
      }
      .speech-bubble p {
        margin: 0;
        font-weight: 600;
        color: var(--deep-forest);
      }
      .speech-bubble__attribution {
        font-size: var(--step--1);
        color: var(--ink-muted);
      }

      .reflection-inputs,
      .motivation-inputs,
      .interest-inputs {
        display: grid;
        gap: var(--space-3);
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      }
      .reflection-input,
      .motivation-input,
      .interest-input {
        padding: var(--space-3);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.18);
        background: rgba(255, 255, 255, 0.85);
        font-family: var(--font-body);
        font-size: var(--step-0);
        resize: vertical;
        min-height: 90px;
        box-shadow: var(--shadow-1);
      }
      .reflection-input:nth-child(1) { background: rgba(198, 170, 119, 0.18); }
      .reflection-input:nth-child(2) { background: rgba(156, 175, 136, 0.18); }
      .reflection-input:nth-child(3) { background: rgba(184, 197, 166, 0.18); }
      .reflection-input:nth-child(4) { background: rgba(122, 132, 113, 0.15); }
      .reflection-input:nth-child(5) { background: rgba(47, 58, 43, 0.12); color: var(--soft-white); }
      .motivation-input:nth-child(odd) { background: rgba(156, 175, 136, 0.18); }
      .motivation-input:nth-child(even) { background: rgba(198, 170, 119, 0.18); }
      .interest-input:nth-child(odd) { background: rgba(184, 197, 166, 0.18); }
      .interest-input:nth-child(even) { background: rgba(156, 175, 136, 0.14); }
      textarea:focus {
        outline: none;
        box-shadow: var(--ring);
      }

      .knowledge-cards,
      .approach-grid,
      .module-cards,
      .ethics-grid,
      .toolkit-grid,
      .insight-steps,
      .step-cards {
        display: grid;
        gap: var(--space-4);
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
      .info-card,
      .mindset-card,
      .approach-card,
      .module-card,
      .ethics-card,
      .toolkit-card,
      .insight-step,
      .step-card {
        display: grid;
        gap: var(--space-3);
        padding: clamp(18px, 3vw, 26px);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(122, 132, 113, 0.16);
        background: rgba(255, 255, 255, 0.88);
        box-shadow: var(--shadow-1);
      }
      .info-card i,
      .mindset-card i,
      .approach-card i,
      .module-card i,
      .ethics-card i,
      .toolkit-card i,
      .insight-step__badge,
      .step-card__icon {
        color: var(--secondary-sage);
        font-size: 1.8rem;
      }
      .mindset-card h3,
      .approach-card h3,
      .module-card h3,
      .ethics-card h3,
      .toolkit-card h3,
      .insight-step h3,
      .step-card h3 {
        margin: 0;
        font-size: var(--step-1);
        color: var(--deep-forest);
      }
      .mindset-card p,
      .info-card p,
      .approach-card p,
      .module-card p,
      .ethics-card p,
      .toolkit-card p,
      .insight-step p,
      .step-card p {
        margin: 0;
        color: var(--ink-muted);
      }
      .insight-step {
        text-align: left;
        padding-top: var(--space-5);
      }
      .insight-step__badge {
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        display: grid;
        place-items: center;
        background: rgba(156, 175, 136, 0.25);
      }

      .mindset-grid {
        display: grid;
        gap: var(--space-4);
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      }
      .mindset-card {
        background: linear-gradient(160deg, rgba(248, 246, 240, 0.9), rgba(156, 175, 136, 0.2));
      }

      .keyword-explorer {
        display: grid;
        gap: var(--space-3);
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      }
      .keyword-btn {
        border: 1px solid rgba(122, 132, 113, 0.2);
        border-radius: var(--radius-lg);
        padding: var(--space-3);
        background: rgba(255, 255, 255, 0.8);
        font-weight: 700;
        color: var(--deep-forest);
        cursor: pointer;
        transition: background var(--dur-2) var(--ease-ambient), box-shadow var(--dur-2) var(--ease-ambient);
      }
      .keyword-btn:hover {
        background: var(--hover-sage);
        box-shadow: var(--shadow-1);
      }
      .keyword-btn.is-selected {
        background: color-mix(in srgb, var(--secondary-sage) 80%, white 20%);
        color: white;
        box-shadow: var(--shadow-2);
      }
      .keyword-definition {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: var(--space-3);
        align-items: center;
        padding: clamp(18px, 3vw, 24px);
        border-radius: var(--radius-lg);
        background: rgba(255, 255, 255, 0.85);
        border: 1px solid rgba(122, 132, 113, 0.18);
        box-shadow: var(--shadow-1);
        font-weight: 600;
        color: var(--deep-forest);
      }
      .keyword-definition i {
        font-size: 1.6rem;
        color: var(--secondary-sage);
      }

      .module-quiz-layout {
        display: grid;
        gap: var(--space-5);
      }
      @media (min-width: 960px) {
        .module-quiz-layout {
          grid-template-columns: minmax(0, 3fr) minmax(220px, 1fr);
          align-items: start;
        }
      }
      .module-quiz p {
        font-weight: 600;
        color: var(--deep-forest);
      }
      .module-quiz select {
        margin-left: var(--space-3);
        min-width: 140px;
        padding: var(--space-2) var(--space-3);
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.35);
        font-family: var(--font-body);
      }
      .module-reference {
        background: rgba(248, 246, 240, 0.85);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        border: 1px solid rgba(122, 132, 113, 0.16);
        box-shadow: var(--shadow-1);
      }
      .module-reference h3 {
        margin-top: 0;
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }
      .module-reference ul {
        margin: 0;
        padding-left: var(--space-5);
        color: var(--ink-muted);
        display: grid;
        gap: var(--space-2);
      }

      .qa-table-wrapper {
        overflow-x: auto;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-1);
      }
      .qa-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 560px;
        background: rgba(255, 255, 255, 0.92);
      }
      .qa-table th,
      .qa-table td {
        border: 1px solid rgba(122, 132, 113, 0.18);
        padding: var(--space-3);
        text-align: left;
      }
      .qa-table th {
        background: color-mix(in srgb, var(--warm-cream) 80%, white 20%);
        font-size: var(--step-1);
        color: var(--deep-forest);
      }
      .qa-table textarea {
        width: 100%;
        min-height: 100px;
        border-radius: var(--radius-sm);
        border: 1px solid rgba(122, 132, 113, 0.25);
        padding: var(--space-2) var(--space-3);
        font-family: var(--font-body);
        font-size: var(--step-0);
        background: rgba(255, 255, 255, 0.9);
      }

      .step-card {
        text-align: center;
        position: relative;
        overflow: hidden;
      }
      .step-card::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(160deg, rgba(156, 175, 136, 0.18), transparent 65%);
        pointer-events: none;
      }
      .step-card__icon {
        width: 48px;
        height: 48px;
        border-radius: 16px;
        display: grid;
        place-items: center;
        margin: 0 auto;
        background: color-mix(in srgb, var(--secondary-sage) 70%, white 30%);
        color: white;
        box-shadow: var(--shadow-2);
        font-size: 1.6rem;
      }

      .matching-activity {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-4);
          align-items: start;
        }
        .matching-list { list-style: none; padding: 0; margin: 0; display: grid; gap: var(--space-3); }
        .match-item {
            padding: var(--space-3);
            border-radius: var(--radius-sm);
            border: 2px solid var(--border-sage);
            background: rgba(255,255,255,0.8);
            cursor: pointer;
            transition: all var(--dur-2) var(--ease-ambient);
        }
        .match-item:hover { background: var(--hover-sage); border-color: var(--secondary-sage); }
        .match-item.selected { background: var(--tertiary-sage); color: var(--deep-forest); border-color: var(--primary-sage); font-weight: bold; }
        .match-item.correct { border-color: #28a745; background-color: #e9f5ec; }
        .match-item.incorrect { border-color: #dc3545; background-color: #fbe9eb; }

        .ranking-list { list-style-type: none; padding: 0; margin: 0; display: grid; gap: var(--space-3); }
        .ranking-item { display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-sm); border: 1px solid var(--border-sage); background: rgba(255,255,255,0.8); }
        .rank-handle { cursor: grab; color: var(--tertiary-sage); }
        .rank-number { font-weight: 800; color: var(--primary-sage); font-size: var(--step-1); }

        .drop-zone-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); margin-top: var(--space-4); }
        .drop-zone { border: 2px dashed var(--tertiary-sage); border-radius: var(--radius-lg); padding: var(--space-4); min-height: 150px; background: rgba(156, 175, 136, 0.05); }
        .drop-zone h4 { margin: 0 0 var(--space-3); }
        .draggable { padding: var(--space-2) var(--space-3); background: var(--warm-cream); border: 1px solid var(--dried-clay); border-radius: var(--radius-sm); cursor: grab; margin-bottom: var(--space-2); }
        .draggable-bank { padding: var(--space-3); border: 1px solid var(--border-sage); border-radius: var(--radius-lg); display: flex; flex-wrap: wrap; gap: var(--space-2); }

        .ordering-list { list-style: none; padding: 0; margin: 0; display: grid; gap: var(--space-3); }
        .order-item { display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-sm); border: 1px solid var(--border-sage); background: rgba(255,255,255,0.8); }
        .order-handle { cursor: grab; color: var(--tertiary-sage); }

        .gap-fill-box { border: 1px solid var(--border-sage); border-radius: var(--radius-lg); padding: var(--space-4); background: var(--warm-cream); }
        .gap-fill-box p { font-weight: bold; margin: 0 0 var(--space-2); }
        .gap-fill-box span { display: inline-block; margin: var(--space-1); }

        .feedback { margin-top: var(--space-4); font-weight: bold; padding: var(--space-3); border-radius: var(--radius-sm); display: none; }
        .feedback.correct { background: #e9f5ec; color: #28a745; }
        .feedback.incorrect { background: #fbe9eb; color: #dc3545; }

        .annotation-highlight {
          background: var(--annotation-color, rgba(142, 77, 255, 0.32));
          color: var(--ink);
          border-radius: 6px;
          padding: 0 2px;
          box-decoration-break: clone;
          cursor: pointer;
          transition:
            box-shadow var(--dur-2) var(--ease-ambient),
            background var(--dur-2) var(--ease-ambient);
        }
        .annotation-highlight.is-active {
          box-shadow: 0 0 0 4px rgba(142, 77, 255, 0.35);
        }
        .annotation-highlight:hover {
          box-shadow: 0 0 0 2px rgba(142, 77, 255, 0.22);
        }
        .annotation-highlight:focus-visible {
          outline: none;
          box-shadow: var(--ring);
        }

        .annotation-overlay {
          position: absolute;
          inset: 0;
          pointer-events: none;
          z-index: 25;
          grid-column: 1 / -1;
        }
        .annotation-connector {
          position: absolute;
          height: 2px;
          background: rgba(122, 132, 113, 0.35);
          border-radius: 999px;
          transition: opacity var(--dur-2) var(--ease-ambient);
          opacity: 0.9;
          transform-origin: 0 50%;
        }

    </style>
</head>
<body>
    <div id="app-wrapper">
        <div id="activity-shell">
            <main id="activity-container">

                <header class="presentation-header" aria-label="Session tools">
                    <div class="session-tools" id="presentation-tools" data-open="false">
                        <button type="button" class="session-tools__trigger" id="session-tools-toggle" aria-haspopup="true" aria-expanded="false" aria-controls="session-tools-panel">
                            <span class="visually-hidden">Toggle session tools</span>
                        </button>
                        <div class="session-tools__panel" id="session-tools-panel" role="group" aria-label="Session tools" hidden>
                            <div class="session-tools__header">
                                <h2 class="session-tools__title">Session tools</h2>
                                <p class="session-tools__hint">Save or restore your annotated slides.</p>
                            </div>
                            <div class="session-tools__actions">
                                <button type="button" class="activity-btn" id="save-annotations-btn">
                                    <i class="fa-solid fa-floppy-disk" aria-hidden="true"></i> Save annotations
                                </button>
                                <button type="button" class="activity-btn secondary" id="load-annotations-btn">
                                    <i class="fa-solid fa-folder-open" aria-hidden="true"></i> Load annotations
                                </button>
                                <input type="file" id="load-annotations-input" accept="application/json" hidden>
                                <p class="session-tools__hint">Loading will replace the current slide content.</p>
                            </div>
                            <section class="textbox textbox--outline session-tools__highlight" aria-label="Annotation controls">
                                <div class="session-tools__highlight-intro">
                                    <span class="text-eyebrow">Markup mode</span>
                                    <p class="text-muted text-measure">Open the header highlighter to spotlight key language and capture facilitation notes in context.</p>
                                </div>
                                <div id="annotation-tool" class="annotation-tool" data-active="false">
                                    <button type="button" class="annotation-tool__toggle" id="annotation-toggle" aria-controls="annotation-palette" aria-expanded="false" aria-pressed="false">
                                        <span class="annotation-tool__toggle-icon" aria-hidden="true">
                                            <i class="fa-solid fa-highlighter"></i>
                                        </span>
                                        <span class="annotation-tool__toggle-copy">
                                            <span class="annotation-tool__toggle-title">Highlighter</span>
                                            <span class="annotation-tool__toggle-subtitle">Enable to add slide notes</span>
                                        </span>
                                        <span class="annotation-tool__state" id="annotation-toggle-state">Off</span>
                                    </button>
                                    <div class="annotation-tool__palette" id="annotation-palette" aria-hidden="true" role="group" aria-label="Highlight palette">
                                        <span class="annotation-tool__label">Highlight palette</span>
                                        <p class="annotation-tool__hint">Choose Purple, Gold, Green, or Red, then brush over the text.</p>
                                        <div class="annotation-tool__swatches" role="group" aria-label="Highlight colours">
                                            <button type="button" class="annotation-tool__color is-selected" data-color="rgba(142, 77, 255, 0.4)" style="--swatch: rgba(142, 77, 255, 0.7);" aria-pressed="true" aria-label="Vibrant purple highlight"></button>
                                            <button type="button" class="annotation-tool__color" data-color="rgba(246, 193, 1, 0.45)" style="--swatch: rgba(246, 193, 1, 0.65);" aria-pressed="false" aria-label="Radiant gold highlight"></button>
                                            <button type="button" class="annotation-tool__color" data-color="rgba(46, 204, 113, 0.4)" style="--swatch: rgba(46, 204, 113, 0.55);" aria-pressed="false" aria-label="Emerald green highlight"></button>
                                            <button type="button" class="annotation-tool__color" data-color="rgba(255, 77, 109, 0.4)" style="--swatch: rgba(255, 77, 109, 0.6);" aria-pressed="false" aria-label="Rose red highlight"></button>
                                        </div>
                                    </div>
                                </div>
                                <p class="session-tools__status text-muted text-measure" id="annotation-mode-status"><strong>Highlighting off.</strong> Select text freely to copy.</p>
                            </section>
                        </div>
                    </div>
                </header>

                <div id="slides-root">
                    <!-- SLIDE 1: Welcome -->
                    <div class="slide active" id="slide-1">
                        <div class="slide-content slide-content--centered welcome-slide">
                            <div class="welcome-card">
                                <div class="welcome-card__icon" aria-hidden="true">
                                    <i class="fa-solid fa-hand-sparkles"></i>
                                </div>
                                <h2 class="welcome-card__title">Welcome, dear students.</h2>
                                <p class="welcome-card__body">We'll begin when everyone has arrived.</p>
                                <p class="welcome-card__body">Thank you for your patience.</p>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 2: Grounding Exercise -->
                    <div class="slide" id="slide-2">
                        <div class="full-image-slide" style="--slide-background: url('https://images.pexels.com/photos/1276204/pexels-photo-1276204.jpeg?auto=compress&cs=tinysrgb&h=900');">
                            <div class="full-image-slide__overlay">
                                <div class="grounding-card">
                                    <div class="grounding-card__line">
                                        <i class="fa-solid fa-feather-pointed" aria-hidden="true"></i>
                                        <span>Take a deep breath in. Hold. Slowly release.</span>
                                    </div>
                                    <div class="grounding-card__line">
                                        <i class="fa-solid fa-leaf" aria-hidden="true"></i>
                                        <span>Take one more deep breath in. Hold. Slowly release.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 3: Who's in the Room -->
                    <div class="slide" id="slide-3">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-people-group"></i> Who's in the Room?</h2>
                            <p class="section-intro__descriptor text-measure">Capture our learning community. Use the table to note student perspectives and professional experiences.</p>
                            <div class="participant-table-wrapper">
                                <table class="participant-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fa-solid fa-user-graduate"></i> I'm a student studying...</th>
                                            <th><i class="fa-solid fa-briefcase"></i> I'm a professional working as...</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td><input type="text" placeholder="Student 1"></td><td><input type="text" placeholder="Professional 1"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 2"></td><td><input type="text" placeholder="Professional 2"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 3"></td><td><input type="text" placeholder="Professional 3"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 4"></td><td><input type="text" placeholder="Professional 4"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 5"></td><td><input type="text" placeholder="Professional 5"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 6"></td><td><input type="text" placeholder="Professional 6"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 7"></td><td><input type="text" placeholder="Professional 7"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 8"></td><td><input type="text" placeholder="Professional 8"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 9"></td><td><input type="text" placeholder="Professional 9"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 10"></td><td><input type="text" placeholder="Professional 10"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 11"></td><td><input type="text" placeholder="Professional 11"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 12"></td><td><input type="text" placeholder="Professional 12"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 13"></td><td><input type="text" placeholder="Professional 13"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 14"></td><td><input type="text" placeholder="Professional 14"></td></tr>
                                        <tr><td><input type="text" placeholder="Student 15"></td><td><input type="text" placeholder="Professional 15"></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 4: Sparking Curiosity -->
                    <div class="slide" id="slide-4">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-lightbulb"></i> Sparking Curiosity</h2>
                            <p class="section-intro__descriptor text-measure">Explore real-world storytellers who rely on qualitative insights. Use the carousel arrows to browse.</p>
                            <div class="curiosity-carousel" data-carousel>
                                <button class="carousel-control" type="button" data-carousel-prev aria-label="Previous story">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </button>
                                <div class="carousel-viewport">
                                    <div class="carousel-track" data-carousel-track>
                                        <figure class="curiosity-slide" data-index="0">
                                            <img src="https://images.pexels.com/photos/1181375/pexels-photo-1181375.jpeg?auto=compress&cs=tinysrgb&h=750" alt="An interviewer listening carefully to a guest during a recorded conversation.">
                                            <figcaption><i class="fa-solid fa-microphone"></i> Interviewer uncovering lived experiences</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="1">
                                            <img src="https://images.pexels.com/photos/518543/pexels-photo-518543.jpeg?auto=compress&cs=tinysrgb&h=750" alt="A journalist taking notes during an outdoor press briefing.">
                                            <figcaption><i class="fa-solid fa-newspaper"></i> Journalist chasing nuance beyond headlines</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="2">
                                            <img src="https://images.pexels.com/photos/261949/pexels-photo-261949.jpeg?auto=compress&cs=tinysrgb&h=750" alt="A writer drafting ideas in a bright studio space.">
                                            <figcaption><i class="fa-solid fa-pen-nib"></i> Writer shaping compelling narratives</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="3">
                                            <img src="https://images.pexels.com/photos/712971/pexels-photo-712971.jpeg?auto=compress&cs=tinysrgb&h=750" alt="A researcher observing a community activity outdoors.">
                                            <figcaption><i class="fa-solid fa-person-walking"></i> Field researcher witnessing context</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="4">
                                            <img src="https://images.pexels.com/photos/3184360/pexels-photo-3184360.jpeg?auto=compress&cs=tinysrgb&h=750" alt="A diverse focus group seated in discussion.">
                                            <figcaption><i class="fa-solid fa-people-arrows"></i> Facilitator guiding a focus group</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="5">
                                            <img src="https://images.pexels.com/photos/4144923/pexels-photo-4144923.jpeg?auto=compress&cs=tinysrgb&h=750" alt="Research notes being organised on a desk.">
                                            <figcaption><i class="fa-solid fa-note-sticky"></i> Analyst clustering emergent themes</figcaption>
                                        </figure>
                                        <figure class="curiosity-slide" data-index="6">
                                            <img src="https://images.pexels.com/photos/268533/pexels-photo-268533.jpeg?auto=compress&cs=tinysrgb&h=750" alt="A portable audio recorder placed on a table.">
                                            <figcaption><i class="fa-solid fa-headphones"></i> Storyteller capturing rich audio diaries</figcaption>
                                        </figure>
                                    </div>
                                </div>
                                <button class="carousel-control" type="button" data-carousel-next aria-label="Next story">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </button>
                                <div class="carousel-dots" data-carousel-dots></div>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 5: Real-World Research -->
                    <div class="slide" id="slide-5">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-quote-left"></i> Real-World Research</h2>
                            <p class="section-intro__descriptor text-measure">These voices demonstrate how qualitative research shapes practice. What stands out to you?</p>
                            <div class="speech-bubbles">
                                <article class="speech-bubble">
                                    <i class="fa-solid fa-hospital"></i>
                                    <p>"Our patient interviews revealed routines we never knew were barriers to care."</p>
                                    <span class="speech-bubble__attribution">â€” Clinic director</span>
                                </article>
                                <article class="speech-bubble">
                                    <i class="fa-solid fa-school"></i>
                                    <p>"Shadowing teachers helped us redesign the schedule to honour student energy."</p>
                                    <span class="speech-bubble__attribution">â€” School principal</span>
                                </article>
                                <article class="speech-bubble">
                                    <i class="fa-solid fa-city"></i>
                                    <p>"Residents' walking stories mapped safety gaps we couldn't see in the data."</p>
                                    <span class="speech-bubble__attribution">â€” Urban planner</span>
                                </article>
                                <article class="speech-bubble">
                                    <i class="fa-solid fa-hand-holding-heart"></i>
                                    <p>"Listening circles reframed our program from 'helping' to 'partnering.'"</p>
                                    <span class="speech-bubble__attribution">â€” Non-profit lead</span>
                                </article>
                            </div>
                            <div class="reflection-inputs" aria-label="Audience reflections">
                                <textarea class="reflection-input" rows="2" placeholder="Reflection 1"></textarea>
                                <textarea class="reflection-input" rows="2" placeholder="Reflection 2"></textarea>
                                <textarea class="reflection-input" rows="2" placeholder="Reflection 3"></textarea>
                                <textarea class="reflection-input" rows="2" placeholder="Reflection 4"></textarea>
                                <textarea class="reflection-input" rows="2" placeholder="Reflection 5"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 6: What is Qualitative Research? -->
                    <div class="slide" id="slide-6">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-compass"></i> What is Qualitative Research?</h2>
                            <p class="section-intro__descriptor text-measure">Anchor our shared understanding with three essentials.</p>
                            <div class="knowledge-cards">
                                <article class="info-card">
                                    <i class="fa-solid fa-comments"></i>
                                    <h3>Meaning-making</h3>
                                    <p>Investigates how people interpret experiences, language, and symbols in their contexts.</p>
                                </article>
                                <article class="info-card">
                                    <i class="fa-solid fa-users"></i>
                                    <h3>Context matters</h3>
                                    <p>Looks closely at environments, relationships, and histories shaping participants' stories.</p>
                                </article>
                                <article class="info-card">
                                    <i class="fa-solid fa-spell-check"></i>
                                    <h3>Iterative learning</h3>
                                    <p>Alternates between gathering insights and refining questions to follow emerging themes.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 7: The Qualitative Mindset -->
                    <div class="slide" id="slide-7">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-brain"></i> The Qualitative Mindset</h2>
                            <p class="section-intro__descriptor text-measure">Blend stance, skill, and practice. Use the prompts to guide discussion.</p>
                            <div class="mindset-grid">
                                <article class="mindset-card">
                                    <h3><i class="fa-solid fa-eye"></i> Observe generously</h3>
                                    <p>Notice gestures, pauses, and environments. What do they tell you about meaning?</p>
                                </article>
                                <article class="mindset-card">
                                    <h3><i class="fa-solid fa-ear-listen"></i> Listen deeply</h3>
                                    <p>Invite stories with open questions. Reflect back to ensure understanding.</p>
                                </article>
                                <article class="mindset-card">
                                    <h3><i class="fa-solid fa-scale-balanced"></i> Hold complexity</h3>
                                    <p>Document tensions without rushing to tidy conclusions. Complexity is data.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 8: Your Motivation -->
                    <div class="slide" id="slide-8">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-heart"></i> Your Motivation</h2>
                            <p class="section-intro__descriptor text-measure">Type in real time as students share why qualitative research matters to them.</p>
                            <div class="motivation-inputs" aria-label="Motivation responses">
                                <textarea class="motivation-input" rows="2" placeholder="Motivation 1"></textarea>
                                <textarea class="motivation-input" rows="2" placeholder="Motivation 2"></textarea>
                                <textarea class="motivation-input" rows="2" placeholder="Motivation 3"></textarea>
                                <textarea class="motivation-input" rows="2" placeholder="Motivation 4"></textarea>
                                <textarea class="motivation-input" rows="2" placeholder="Motivation 5"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 9: Key Words for Our Journey -->
                    <div class="slide" id="slide-9">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-key"></i> Key Words for Our Journey</h2>
                            <p class="section-intro__descriptor text-measure">Select a concept to anchor our language. One choice stays highlighted until you pick another.</p>
                            <div class="keyword-explorer" data-choice-group>
                                <button type="button" class="keyword-btn" data-definition="Ethics keeps participants safe, honoured, and informed at every step.">A. Ethics</button>
                                <button type="button" class="keyword-btn" data-definition="Positionality helps us name how our identities shape what we notice.">B. Positionality</button>
                                <button type="button" class="keyword-btn" data-definition="Triangulation cross-checks insights using multiple data sources.">C. Triangulation</button>
                                <button type="button" class="keyword-btn" data-definition="Thick description paints vivid scenes so others can interpret findings.">D. Thick Description</button>
                            </div>
                            <div class="keyword-definition" id="keyword-definition" aria-live="polite">
                                <i class="fa-solid fa-circle-info"></i>
                                <span>Select a keyword to reveal a working definition.</span>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 10: Approaches at a Glance -->
                    <div class="slide" id="slide-10">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-sitemap"></i> Approaches at a Glance</h2>
                            <p class="section-intro__descriptor text-measure">Use the cards to summarise how each approach contributes to qualitative insight.</p>
                            <div class="approach-grid">
                                <article class="approach-card">
                                    <i class="fa-solid fa-people-line"></i>
                                    <h3>Ethnography</h3>
                                    <p>Immerses the researcher in daily life to understand culture from within.</p>
                                </article>
                                <article class="approach-card">
                                    <i class="fa-solid fa-seedling"></i>
                                    <h3>Grounded Theory</h3>
                                    <p>Builds theory from data through constant comparison of codes and categories.</p>
                                </article>
                                <article class="approach-card">
                                    <i class="fa-solid fa-person-rays"></i>
                                    <h3>Phenomenology</h3>
                                    <p>Explores the essence of lived experience across participants.</p>
                                </article>
                                <article class="approach-card">
                                    <i class="fa-solid fa-people-group"></i>
                                    <h3>Participatory Action</h3>
                                    <p>Partners with communities to co-create knowledge and change.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 11: Course Modules -->
                    <div class="slide" id="slide-11">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-layer-group"></i> Course Modules</h2>
                            <p class="section-intro__descriptor text-measure">Here is our roadmap for the term. Keep these modules visible as we move through the course.</p>
                            <div class="module-cards">
                                <article class="module-card">
                                    <h3><i class="fa-solid fa-map-location-dot"></i> Module 1</h3>
                                    <p>Framing research questions with curiosity and care.</p>
                                </article>
                                <article class="module-card">
                                    <h3><i class="fa-solid fa-user-pen"></i> Module 2</h3>
                                    <p>Designing ethical recruitment and informed consent.</p>
                                </article>
                                <article class="module-card">
                                    <h3><i class="fa-solid fa-microphone-lines"></i> Module 3</h3>
                                    <p>Conducting interviews, focus groups, and observations.</p>
                                </article>
                                <article class="module-card">
                                    <h3><i class="fa-solid fa-highlighter"></i> Module 4</h3>
                                    <p>Coding data and developing themes with rigour.</p>
                                </article>
                                <article class="module-card">
                                    <h3><i class="fa-solid fa-chart-line"></i> Module 5</h3>
                                    <p>Translating insights into action and storytelling.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 12: Let's Check Our Understanding -->
                    <div class="slide" id="slide-12">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-clipboard-question"></i> Let's Check Our Understanding</h2>
                            <p class="section-intro__descriptor text-measure">Use the modules as a reference while you respond to the comprehension checks.</p>
                            <div class="module-quiz-layout">
                                <div class="module-quiz" id="module-quiz">
                                    <p>1. Which module emphasises participant wellbeing?
                                        <select data-answer="Module 2"><option>Select...</option><option>Module 1</option><option>Module 2</option><option>Module 3</option><option>Module 4</option><option>Module 5</option></select>
                                    </p>
                                    <p>2. Where do we practise turning themes into stories?
                                        <select data-answer="Module 5"><option>Select...</option><option>Module 1</option><option>Module 2</option><option>Module 3</option><option>Module 4</option><option>Module 5</option></select>
                                    </p>
                                    <p>3. Which module trains our interviewing techniques?
                                        <select data-answer="Module 3"><option>Select...</option><option>Module 1</option><option>Module 2</option><option>Module 3</option><option>Module 4</option><option>Module 5</option></select>
                                    </p>
                                </div>
                                <aside class="module-reference">
                                    <h3><i class="fa-solid fa-book-open"></i> Course Modules</h3>
                                    <ul>
                                        <li>Module 1 â€” Framing research questions</li>
                                        <li>Module 2 â€” Ethical recruitment</li>
                                        <li>Module 3 â€” Fieldwork techniques</li>
                                        <li>Module 4 â€” Coding and analysis</li>
                                        <li>Module 5 â€” Insight storytelling</li>
                                    </ul>
                                </aside>
                            </div>
                            <div class="activity-actions">
                                <button class="activity-btn" onclick="checkSelectAnswers('module-quiz')">Check Answers</button>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 13: Your Interests -->
                    <div class="slide" id="slide-13">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-compass-drafting"></i> Your Interests</h2>
                            <p class="section-intro__descriptor text-measure">Document topics learners hope to explore during the course.</p>
                            <div class="interest-inputs" aria-label="Interest responses">
                                <textarea class="interest-input" rows="2" placeholder="Interest 1"></textarea>
                                <textarea class="interest-input" rows="2" placeholder="Interest 2"></textarea>
                                <textarea class="interest-input" rows="2" placeholder="Interest 3"></textarea>
                                <textarea class="interest-input" rows="2" placeholder="Interest 4"></textarea>
                                <textarea class="interest-input" rows="2" placeholder="Interest 5"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 14: Ethics in Practice -->
                    <div class="slide" id="slide-14">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-scale-balanced"></i> Ethics in Practice</h2>
                            <p class="section-intro__descriptor text-measure">Use these prompts to discuss how we'll protect participants and ourselves.</p>
                            <div class="ethics-grid">
                                <article class="ethics-card">
                                    <h3><i class="fa-solid fa-user-shield"></i> Respect</h3>
                                    <p>How will we honour names, pronouns, and cultural practices during fieldwork?</p>
                                </article>
                                <article class="ethics-card">
                                    <h3><i class="fa-solid fa-lock"></i> Confidentiality</h3>
                                    <p>What systems will we use to store data safely and share only what is consented?</p>
                                </article>
                                <article class="ethics-card">
                                    <h3><i class="fa-solid fa-hands-holding"></i> Care</h3>
                                    <p>How will we debrief participants and ourselves after emotionally heavy sessions?</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 15: Data Collection Toolkit -->
                    <div class="slide" id="slide-15">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-toolbox"></i> Data Collection Toolkit</h2>
                            <p class="section-intro__descriptor text-measure">Pair each method with a classroom example to show its strength.</p>
                            <div class="toolkit-grid">
                                <article class="toolkit-card">
                                    <h3><i class="fa-solid fa-comments"></i> Semi-structured interviews</h3>
                                    <p>Students explore family food traditions to understand identity and change.</p>
                                </article>
                                <article class="toolkit-card">
                                    <h3><i class="fa-solid fa-people-group"></i> Focus groups</h3>
                                    <p>Community organisers co-create guidelines for safer public transit.</p>
                                </article>
                                <article class="toolkit-card">
                                    <h3><i class="fa-solid fa-camera-retro"></i> Photo elicitation</h3>
                                    <p>Learners capture workplace artefacts to spark dialogue about culture.</p>
                                </article>
                                <article class="toolkit-card">
                                    <h3><i class="fa-solid fa-book-open"></i> Reflective journals</h3>
                                    <p>Participants log field notes to trace their shifting interpretations.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 16: From Data to Insight -->
                    <div class="slide" id="slide-16">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-chart-simple"></i> From Data to Insight</h2>
                            <p class="section-intro__descriptor text-measure">Trace the journey from raw transcripts to actionable stories.</p>
                            <div class="insight-steps">
                                <article class="insight-step">
                                    <span class="insight-step__badge"><i class="fa-solid fa-file-lines"></i></span>
                                    <h3>Capture</h3>
                                    <p>Transcribe or annotate recordings and field notes with precision.</p>
                                </article>
                                <article class="insight-step">
                                    <span class="insight-step__badge"><i class="fa-solid fa-tags"></i></span>
                                    <h3>Code</h3>
                                    <p>Label meaningful excerpts, then cluster codes into evolving categories.</p>
                                </article>
                                <article class="insight-step">
                                    <span class="insight-step__badge"><i class="fa-solid fa-layer-group"></i></span>
                                    <h3>Synthesise</h3>
                                    <p>Surface patterns, tensions, and questions for further exploration.</p>
                                </article>
                                <article class="insight-step">
                                    <span class="insight-step__badge"><i class="fa-solid fa-bullseye"></i></span>
                                    <h3>Share</h3>
                                    <p>Craft narratives, visuals, and recommendations tailored to stakeholders.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 17: Your Questions -->
                    <div class="slide" id="slide-17">
                        <div class="slide-content">
                            <h2 class="slide-title"><i class="fa-solid fa-circle-question"></i> Your Questions</h2>
                            <p class="section-intro__descriptor text-measure">Log questions as they surface and capture the answers we co-create.</p>
                            <div class="qa-table-wrapper">
                                <table class="qa-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fa-solid fa-question"></i> Question</th>
                                            <th><i class="fa-solid fa-message"></i> Answer</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td><textarea rows="2" placeholder="Question 1"></textarea></td><td><textarea rows="2" placeholder="Answer 1"></textarea></td></tr>
                                        <tr><td><textarea rows="2" placeholder="Question 2"></textarea></td><td><textarea rows="2" placeholder="Answer 2"></textarea></td></tr>
                                        <tr><td><textarea rows="2" placeholder="Question 3"></textarea></td><td><textarea rows="2" placeholder="Answer 3"></textarea></td></tr>
                                        <tr><td><textarea rows="2" placeholder="Question 4"></textarea></td><td><textarea rows="2" placeholder="Answer 4"></textarea></td></tr>
                                        <tr><td><textarea rows="2" placeholder="Question 5"></textarea></td><td><textarea rows="2" placeholder="Answer 5"></textarea></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 18: Let's Get Started! -->
                    <div class="slide" id="slide-18">
                        <div class="slide-content slide-content--centered">
                            <h2 class="slide-title"><i class="fa-solid fa-rocket"></i> Let's Get Started!</h2>
                            <p class="section-intro__descriptor text-measure">Follow these steps to register for the collaborative research studio.</p>
                            <div class="step-cards">
                                <article class="step-card">
                                    <div class="step-card__icon"><i class="fa-solid fa-comments"></i></div>
                                    <h3>Step 1</h3>
                                    <p>Open the class chat channel and say hello to the cohort.</p>
                                </article>
                                <article class="step-card">
                                    <div class="step-card__icon"><i class="fa-solid fa-link"></i></div>
                                    <h3>Step 2</h3>
                                    <p>Click the registration link shared in today's session notes.</p>
                                </article>
                                <article class="step-card">
                                    <div class="step-card__icon"><i class="fa-solid fa-clipboard-list"></i></div>
                                    <h3>Step 3</h3>
                                    <p>Fill out the form with your project idea and availability.</p>
                                </article>
                                <article class="step-card">
                                    <div class="step-card__icon"><i class="fa-solid fa-paper-plane"></i></div>
                                    <h3>Step 4</h3>
                                    <p>Submit, then check your email for confirmation and next actions.</p>
                                </article>
                            </div>
                        </div>
                    </div>

                    <!-- SLIDE 19: Thank You -->
                    <div class="slide" id="slide-19">
                        <div class="full-image-slide" style="--slide-background: url('https://images.pexels.com/photos/733174/pexels-photo-733174.jpeg?auto=compress&cs=tinysrgb&h=900');">
                            <div class="full-image-slide__overlay">
                                <div class="closing-card">
                                    <div class="closing-card__icon" aria-hidden="true">
                                        <i class="fa-solid fa-mountain-sun"></i>
                                    </div>
                                    <h2 class="closing-card__title">Thank you for your presence.</h2>
                                    <p class="closing-card__body">Carry this grounded energy into your next conversation, and notice the stories waiting to be heard.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- SLIDE NAVIGATION -->
                <div class="slide-status-bar">
                    <div class="slide-status-bar__progress">
                        <div class="slide-status-bar__progress-track">
                            <div class="slide-status-bar__progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                    <div class="slide-status-bar__row">
                          <p class="slide-status-bar__count" id="slide-counter">Slide 1 of 19</p>
                        <div class="slide-status-bar__actions">
                            <button class="activity-btn secondary" id="prev-btn" disabled><i class="fa-solid fa-arrow-left"></i> Previous</button>
                            <button class="activity-btn" id="next-btn">Next <i class="fa-solid fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>

                <div class="annotation-popover" id="annotation-popover" role="dialog" aria-modal="false" aria-hidden="true" aria-labelledby="annotation-note-label">
                    <div class="annotation-popover__inner">
                        <button type="button" class="annotation-popover__close" id="annotation-close" aria-label="Close annotation editor">
                            <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                        </button>
                        <p class="annotation-popover__label" id="annotation-note-label">Slide note</p>
                        <textarea id="annotation-note" class="annotation-tool__textarea" aria-labelledby="annotation-note-label" placeholder="Describe the teaching point you want learners to notice."></textarea>
                        <p class="annotation-tool__message" id="annotation-message" role="alert"></p>
                        <div class="annotation-tool__actions">
                            <button type="button" class="annotation-tool__action danger" id="annotation-remove" hidden>
                                <i class="fa-solid fa-trash-can" aria-hidden="true"></i>
                                Remove highlight
                            </button>
                            <button type="button" class="annotation-tool__action primary" id="annotation-save">
                                <i class="fa-solid fa-bookmark" aria-hidden="true"></i>
                                Save note
                            </button>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const slidesRoot = document.getElementById('slides-root');
    const nextBtn = document.getElementById('next-btn');
    const prevBtn = document.getElementById('prev-btn');
    const slideCounter = document.getElementById('slide-counter');
    const progressFill = document.getElementById('progress-fill');
    const saveAnnotationsBtn = document.getElementById('save-annotations-btn');
    const loadAnnotationsBtn = document.getElementById('load-annotations-btn');
    const loadAnnotationsInput = document.getElementById('load-annotations-input');

    const sessionTools = document.getElementById('presentation-tools');
    const sessionToolsToggle = document.getElementById('session-tools-toggle');
    const sessionToolsPanel = document.getElementById('session-tools-panel');

    const annotationTool = document.getElementById('annotation-tool');
    const annotationToggleBtn = document.getElementById('annotation-toggle');
    const annotationPalette = document.getElementById('annotation-palette');
    const annotationPopover = document.getElementById('annotation-popover');
    const colorButtons = annotationTool ? Array.from(annotationTool.querySelectorAll('.annotation-tool__color')) : [];
    const annotationTextarea = document.getElementById('annotation-note');
    const annotationSaveBtn = document.getElementById('annotation-save');
    const annotationCloseBtn = document.getElementById('annotation-close');
    const annotationRemoveBtn = document.getElementById('annotation-remove');
    const annotationMessage = document.getElementById('annotation-message');
    const annotationModeStatus = document.getElementById('annotation-mode-status');
    const annotationToggleState = document.getElementById('annotation-toggle-state');

    const defaultHighlightColor = 'rgba(142, 77, 255, 0.4)';

    let slides = [];
    let totalSlides = 0;
    let currentSlide = 0;

    let highlightingEnabled = false;
    let activeHighlight = null;
    let pendingHighlight = null;
    let currentHighlightColor = defaultHighlightColor;
    const connectorRegistry = new Map();
    const slideComponentsCache = new WeakMap();
    let annotationSystemReady = false;
    let resizeRaf = null;

    refreshSlides();
    initializeActivities();
    initializeAnnotationSystem();

    nextBtn.addEventListener('click', () => {
        if (currentSlide < totalSlides - 1) {
            currentSlide += 1;
            updateSlideView();
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentSlide > 0) {
            currentSlide -= 1;
            updateSlideView();
        }
    });

    if (sessionTools && sessionToolsToggle && sessionToolsPanel) {
        sessionToolsToggle.addEventListener('click', () => {
            const open = sessionTools.dataset.open === 'true';
            setSessionToolsOpen(!open);
        });

        document.addEventListener('click', event => {
            if (!sessionTools.contains(event.target)) {
                setSessionToolsOpen(false);
            }
        });

        sessionTools.addEventListener('keydown', event => {
            if (event.key === 'Escape') {
                setSessionToolsOpen(false);
                sessionToolsToggle.focus({ preventScroll: true });
            }
        });
    }

    if (saveAnnotationsBtn) {
        saveAnnotationsBtn.addEventListener('click', () => {
            const exportPayload = {
                savedAt: new Date().toISOString(),
                documentTitle: document.title,
                slidesHtml: slidesRoot.innerHTML
            };
            const blob = new Blob([JSON.stringify(exportPayload, null, 2)], { type: 'application/json' });
            const fileName = `eco-activist-annotations-${Date.now()}.json`;
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        });
    }

    if (loadAnnotationsBtn && loadAnnotationsInput) {
        loadAnnotationsBtn.addEventListener('click', () => {
            loadAnnotationsInput.click();
        });

        loadAnnotationsInput.addEventListener('change', event => {
            const [file] = event.target.files || [];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = loadEvent => {
                try {
                    const payload = JSON.parse(loadEvent.target.result);
                    if (payload && typeof payload.slidesHtml === 'string') {
                        slidesRoot.innerHTML = payload.slidesHtml;
                        refreshSlides();
                        initializeActivities();
                        initializeAnnotationSystem();
                    } else {
                        window.alert('The selected file does not contain any slides to load.');
                    }
                } catch (error) {
                    console.error('Unable to load annotations', error);
                    window.alert('We could not load that file. Please choose a valid annotations export.');
                } finally {
                    loadAnnotationsInput.value = '';
                }
            };
            reader.readAsText(file);
        });
    }

    if (annotationTool && annotationToggleBtn) {
        annotationToggleBtn.addEventListener('click', () => {
            setHighlightMode(!highlightingEnabled);
        });
    }

    annotationCloseBtn?.addEventListener('click', () => {
        clearActiveHighlight();
        hideAnnotationMessage();
    });

    annotationSaveBtn?.addEventListener('click', handleAnnotationSave);
    annotationRemoveBtn?.addEventListener('click', handleAnnotationRemove);

    colorButtons.forEach(button => {
        button.addEventListener('click', () => selectColor(button));
    });

    document.addEventListener('keydown', event => {
        if (event.key === 'Escape') {
            if (annotationPopover && annotationPopover.classList.contains('is-visible')) {
                clearActiveHighlight();
                return;
            }
            if (highlightingEnabled) {
                setHighlightMode(false);
            }
        }
    });

    function setSessionToolsOpen(open) {
        if (!sessionTools || !sessionToolsPanel || !sessionToolsToggle) return;
        sessionTools.dataset.open = open ? 'true' : 'false';
        sessionToolsPanel.hidden = !open;
        sessionToolsToggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        if (open) {
            const focusable = sessionToolsPanel.querySelector('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])');
            focusable?.focus({ preventScroll: true });
        }
    }

    function refreshSlides() {
        slides = Array.from(slidesRoot.querySelectorAll('.slide'));
        totalSlides = slides.length;
        if (!totalSlides) {
            slideCounter.textContent = 'Slide 0 of 0';
            progressFill.style.setProperty('--progress', '0%');
            prevBtn.disabled = true;
            nextBtn.disabled = true;
            return;
        }

        const activeIndex = slides.findIndex(slide => slide.classList.contains('active'));
        currentSlide = activeIndex >= 0 ? activeIndex : Math.min(currentSlide, totalSlides - 1);
        updateSlideView();
    }

    function updateSlideView() {
        if (!slides.length) return;

        slides.forEach((slide, index) => {
            slide.classList.toggle('active', index === currentSlide);
        });

        slideCounter.textContent = `Slide ${currentSlide + 1} of ${totalSlides}`;
        const progressPercentage = totalSlides <= 1 ? 100 : (currentSlide / (totalSlides - 1)) * 100;
        progressFill.style.setProperty('--progress', `${progressPercentage}%`);

        prevBtn.disabled = currentSlide === 0;
        nextBtn.disabled = currentSlide === totalSlides - 1;

        scheduleConnectorUpdate();
    }

    function initializeAnnotationSystem() {
        if (!slidesRoot) return;
        setupSlidesForAnnotations();
        updateAnnotationModeStatus();
        scheduleConnectorUpdate();
    }

    function setupSlidesForAnnotations() {
        connectorRegistry.forEach(entry => {
            if (entry.line?.parentNode) {
                entry.line.parentNode.removeChild(entry.line);
            }
        });
        connectorRegistry.clear();

        slides.forEach(slide => {
            const components = ensureSlideComponents(slide);
            components.overlay.innerHTML = '';
            const cards = Array.from(components.list.querySelectorAll('.slide-annotation'));
            cards.forEach(card => {
                if (card.dataset.annotationBound === 'true') return;
                card.dataset.annotationBound = 'true';
                card.addEventListener('click', () => handleCardFocus(card.dataset.annotationId));
            });
            updatePanelPlaceholder(components);
        });

        const highlights = slidesRoot.querySelectorAll('.annotation-highlight');
        highlights.forEach(highlight => {
            if (!highlight.dataset.annotationId) {
                highlight.dataset.annotationId = `annotation-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;
            }
            const color = highlight.dataset.color || defaultHighlightColor;
            highlight.dataset.color = color;
            highlight.style.setProperty('--annotation-color', color);
            if (!highlight.hasAttribute('tabindex')) {
                highlight.setAttribute('tabindex', '0');
                highlight.setAttribute('role', 'note');
            }
            const comment = highlight.dataset.comment;
            if (comment) {
                highlight.setAttribute('aria-label', `Annotation: ${comment}`);
            }
            syncAnnotationCard(highlight);
        });

        if (!annotationSystemReady) {
            slidesRoot.addEventListener('mouseup', handleSelectionMouseUp);
            slidesRoot.addEventListener('click', event => {
                const highlight = event.target.closest('.annotation-highlight');
                if (!highlight) return;
                event.preventDefault();
                openHighlight(highlight, { focusTextarea: true });
            });
            window.addEventListener('resize', scheduleConnectorUpdate);
            document.addEventListener('scroll', scheduleConnectorUpdate, true);
            annotationSystemReady = true;
        }
    }

    function setHighlightMode(active) {
        if (!annotationTool || !annotationToggleBtn) return;
        highlightingEnabled = active;
        annotationTool.classList.toggle('is-active', active);
        annotationTool.dataset.active = active ? 'true' : 'false';
        annotationToggleBtn.setAttribute('aria-expanded', active ? 'true' : 'false');
        annotationToggleBtn.setAttribute('aria-pressed', active ? 'true' : 'false');
        if (annotationPalette) {
            annotationPalette.setAttribute('aria-hidden', active ? 'false' : 'true');
        }
        updateAnnotationModeStatus();
        if (!active) {
            clearActiveHighlight();
            hideAnnotationMessage();
            if (annotationTextarea) {
                annotationTextarea.value = '';
            }
        } else {
            requestAnimationFrame(() => positionAnnotationPopover());
        }
    }

    function updateAnnotationModeStatus() {
        if (!annotationModeStatus) return;
        annotationModeStatus.innerHTML = highlightingEnabled
            ? '<strong>Highlighting on.</strong> Select text to add notes.'
            : '<strong>Highlighting off.</strong> Select text freely to copy.';
        if (annotationToggleState) {
            annotationToggleState.textContent = highlightingEnabled ? 'On' : 'Off';
        }
    }

    function selectColor(button) {
        if (!colorButtons.length) return;
        colorButtons.forEach(btn => {
            const isSelected = btn === button;
            btn.classList.toggle('is-selected', isSelected);
            btn.setAttribute('aria-pressed', isSelected ? 'true' : 'false');
        });
        currentHighlightColor = button.dataset.color || defaultHighlightColor;
        if (activeHighlight) {
            activeHighlight.dataset.color = currentHighlightColor;
            activeHighlight.style.setProperty('--annotation-color', currentHighlightColor);
            syncAnnotationCard(activeHighlight);
            scheduleConnectorUpdate();
        }
    }

    function handleSelectionMouseUp() {
        if (!highlightingEnabled) return;
        setTimeout(() => {
            const range = getValidRange();
            if (!range) return;

            const startHighlight = range.startContainer.parentElement && range.startContainer.parentElement.closest('.annotation-highlight');
            const endHighlight = range.endContainer.parentElement && range.endContainer.parentElement.closest('.annotation-highlight');

            if (startHighlight && startHighlight === endHighlight) {
                openHighlight(startHighlight, { focusTextarea: true });
                window.getSelection().removeAllRanges();
                return;
            }

            if (pendingHighlight && pendingHighlight.isConnected) {
                removeAnnotationCard(pendingHighlight);
                removeConnector(pendingHighlight.dataset.annotationId);
                removeHighlight(pendingHighlight);
            }

            const highlight = createHighlight(range, currentHighlightColor);
            if (!highlight) return;

            pendingHighlight = highlight;
            openHighlight(highlight, { focusTextarea: true, isNew: true });
            window.getSelection().removeAllRanges();
        }, 0);
    }

    function getValidRange() {
        const selection = window.getSelection();
        if (!selection || selection.rangeCount === 0 || selection.isCollapsed) return null;

        const range = selection.getRangeAt(0).cloneRange();
        if (!slidesRoot.contains(range.startContainer) || !slidesRoot.contains(range.endContainer)) {
            return null;
        }

        return range.toString().trim() ? range : null;
    }

    function createHighlight(range, color) {
        try {
            const highlight = document.createElement('span');
            highlight.className = 'annotation-highlight';
            highlight.dataset.annotationId = `annotation-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;
            highlight.dataset.color = color;
            highlight.style.setProperty('--annotation-color', color || defaultHighlightColor);
            highlight.setAttribute('tabindex', '0');
            highlight.setAttribute('role', 'note');

            const fragment = range.extractContents();
            highlight.appendChild(fragment);
            range.insertNode(highlight);
            highlight.normalize();
            slidesRoot.normalize();
            return highlight;
        } catch (error) {
            console.error('Unable to create highlight', error);
            return null;
        }
    }

    function openHighlight(highlight, options = {}) {
        if (!highlight) return;
        setHighlightMode(true);
        if (activeHighlight && activeHighlight !== highlight) {
            activeHighlight.classList.remove('is-active');
        }
        activeHighlight = highlight;
        highlight.classList.add('is-active');

        const color = highlight.dataset.color || currentHighlightColor;
        const matchingButton = colorButtons.find(btn => btn.dataset.color === color);
        if (matchingButton) {
            selectColor(matchingButton);
        } else {
            currentHighlightColor = color;
        }

        if (annotationPopover) {
            annotationPopover.classList.add('is-visible');
            annotationPopover.setAttribute('aria-hidden', 'false');
            requestAnimationFrame(() => positionAnnotationPopover());
        }

        if (annotationTextarea) {
            if (options.isNew) {
                annotationTextarea.value = '';
            } else {
                annotationTextarea.value = highlight.dataset.comment || '';
            }
            if (options.focusTextarea) {
                requestAnimationFrame(() => {
                    annotationTextarea.focus({ preventScroll: true });
                });
            }
        }

        if (annotationRemoveBtn) {
            annotationRemoveBtn.hidden = false;
        }
        hideAnnotationMessage();
    }

    function handleAnnotationSave() {
        if (!activeHighlight || !annotationTextarea) {
            showAnnotationMessage('Highlight text before saving an annotation.');
            return;
        }
        const comment = annotationTextarea.value.trim();
        if (!comment) {
            showAnnotationMessage('Add a note to save your highlight.');
            annotationTextarea.focus({ preventScroll: true });
            return;
        }
        activeHighlight.dataset.comment = comment;
        activeHighlight.dataset.color = currentHighlightColor;
        activeHighlight.style.setProperty('--annotation-color', currentHighlightColor);
        activeHighlight.setAttribute('aria-label', `Annotation: ${comment}`);
        syncAnnotationCard(activeHighlight);
        pendingHighlight = null;
        hideAnnotationMessage();
        scheduleConnectorUpdate();
    }

    function handleAnnotationRemove() {
        if (!activeHighlight) return;
        const annotationId = activeHighlight.dataset.annotationId;
        removeAnnotationCard(activeHighlight);
        removeConnector(annotationId);
        removeHighlight(activeHighlight);
        pendingHighlight = null;
        clearActiveHighlight();
        hideAnnotationMessage();
        scheduleConnectorUpdate();
    }

    function removeHighlight(highlight) {
        if (!highlight) return;
        const parent = highlight.parentNode;
        if (!parent) return;
        while (highlight.firstChild) {
            parent.insertBefore(highlight.firstChild, highlight);
        }
        highlight.remove();
        parent.normalize();
    }

    function clearActiveHighlight() {
        if (activeHighlight) {
            activeHighlight.classList.remove('is-active');
        }
        activeHighlight = null;
        if (annotationTextarea) {
            annotationTextarea.value = '';
        }
        if (annotationRemoveBtn) {
            annotationRemoveBtn.hidden = true;
        }
        hideAnnotationPopover();
    }

    function syncAnnotationCard(highlight) {
        const slide = highlight.closest('.slide');
        if (!slide) return;
        const components = ensureSlideComponents(slide);
        const annotationId = highlight.dataset.annotationId;
        const comment = (highlight.dataset.comment || '').trim();
        const color = highlight.dataset.color || defaultHighlightColor;

        let card = components.list.querySelector(`[data-annotation-id="${annotationId}"]`);
        if (!comment) {
            if (card) {
                card.remove();
            }
            removeConnector(annotationId);
            updatePanelPlaceholder(components);
            return;
        }

        if (!card) {
            card = document.createElement('li');
            card.className = 'slide-annotation';
            card.dataset.annotationId = annotationId;
            card.innerHTML = `
                <span class="slide-annotation__color" aria-hidden="true"></span>
                <p class="slide-annotation__text"></p>
            `;
            card.dataset.annotationBound = 'true';
            card.addEventListener('click', () => handleCardFocus(annotationId));
            components.list.appendChild(card);
        }

        card.querySelector('.slide-annotation__color').style.setProperty('--annotation-color', color);
        card.querySelector('.slide-annotation__text').textContent = comment;
        components.list.hidden = false;
        components.empty.hidden = components.list.children.length > 0;

        registerConnector(annotationId, highlight, card, components.overlay);
    }

    function removeAnnotationCard(highlight) {
        const slide = highlight.closest('.slide');
        if (!slide) return;
        const components = ensureSlideComponents(slide);
        const annotationId = highlight.dataset.annotationId;
        const card = components.list.querySelector(`[data-annotation-id="${annotationId}"]`);
        if (card) {
            card.remove();
            updatePanelPlaceholder(components);
        }
    }

    function ensureSlideComponents(slide) {
        let cache = slideComponentsCache.get(slide);
        if (cache) return cache;

        let panel = slide.querySelector('.slide-annotations');
        if (!panel) {
            panel = document.createElement('aside');
            panel.className = 'slide-annotations';
            panel.setAttribute('aria-label', 'Slide annotations');
            panel.innerHTML = `
                <div class="slide-annotations__header">
                    <h3 class="slide-annotations__title">Annotations</h3>
                    <p class="slide-annotations__intro">Highlights saved for this slide.</p>
                </div>
                <p class="slide-annotations__empty">No annotations yet. Use the highlighter to capture key moments.</p>
                <ol class="slide-annotations__list" hidden></ol>
            `;
            slide.appendChild(panel);
        } else {
            if (!panel.querySelector('.slide-annotations__header')) {
                const header = document.createElement('div');
                header.className = 'slide-annotations__header';
                header.innerHTML = `
                    <h3 class="slide-annotations__title">Annotations</h3>
                    <p class="slide-annotations__intro">Highlights saved for this slide.</p>
                `;
                panel.prepend(header);
            }
            if (!panel.querySelector('.slide-annotations__empty')) {
                const empty = document.createElement('p');
                empty.className = 'slide-annotations__empty';
                empty.textContent = 'No annotations yet. Use the highlighter to capture key moments.';
                panel.appendChild(empty);
            }
            if (!panel.querySelector('.slide-annotations__list')) {
                const list = document.createElement('ol');
                list.className = 'slide-annotations__list';
                list.hidden = true;
                panel.appendChild(list);
            }
        }

        const empty = panel.querySelector('.slide-annotations__empty');
        const list = panel.querySelector('.slide-annotations__list');

        let overlay = slide.querySelector('.annotation-overlay');
        if (!overlay) {
            overlay = document.createElement('div');
            overlay.className = 'annotation-overlay';
            slide.appendChild(overlay);
        }

        cache = { panel, list, empty, overlay };
        slideComponentsCache.set(slide, cache);
        return cache;
    }

    function updatePanelPlaceholder(components) {
        const hasItems = components.list.children.length > 0;
        components.empty.hidden = hasItems;
        components.list.hidden = !hasItems;
    }

    function registerConnector(annotationId, highlight, card, overlay) {
        let entry = connectorRegistry.get(annotationId);
        if (!entry) {
            const line = document.createElement('div');
            line.className = 'annotation-connector';
            entry = { annotationId, line, highlight, card, overlay };
            connectorRegistry.set(annotationId, entry);
        } else {
            entry.highlight = highlight;
            entry.card = card;
            entry.overlay = overlay;
        }
        updateConnectorPosition(entry);
    }

    function removeConnector(annotationId) {
        const entry = connectorRegistry.get(annotationId);
        if (!entry) return;
        if (entry.line?.parentNode) {
            entry.line.parentNode.removeChild(entry.line);
        }
        connectorRegistry.delete(annotationId);
    }

    function updateConnectorPosition(entry) {
        const { line, highlight, card, overlay } = entry;
        if (!highlight?.isConnected || !card?.isConnected || !overlay?.isConnected) {
            removeConnector(entry.annotationId);
            return;
        }
        if (!overlay.contains(line)) {
            overlay.appendChild(line);
        }

        const slide = highlight.closest('.slide');
        if (!slide) {
            removeConnector(entry.annotationId);
            return;
        }

        const slideRect = slide.getBoundingClientRect();
        const highlightRect = highlight.getBoundingClientRect();
        const cardRect = card.getBoundingClientRect();

        const startX = highlightRect.left + highlightRect.width / 2 - slideRect.left;
        const startY = highlightRect.top + highlightRect.height / 2 - slideRect.top;
        const endX = cardRect.left - slideRect.left - 8;
        const endY = cardRect.top + cardRect.height / 2 - slideRect.top;
        const dx = endX - startX;
        const dy = endY - startY;
        const distance = Math.sqrt(dx * dx + dy * dy);
        const angle = Math.atan2(dy, dx) * (180 / Math.PI);

        line.style.width = `${distance}px`;
        line.style.transform = `translate(${startX}px, ${startY}px) rotate(${angle}deg)`;
    }

    function scheduleConnectorUpdate() {
        if (resizeRaf) cancelAnimationFrame(resizeRaf);
        resizeRaf = requestAnimationFrame(updateAllConnectors);
    }

    function updateAllConnectors() {
        connectorRegistry.forEach(entry => updateConnectorPosition(entry));
        positionAnnotationPopover();
    }

    function handleCardFocus(annotationId) {
        if (!annotationId) return;
        const highlight = slidesRoot.querySelector(`.annotation-highlight[data-annotation-id="${annotationId}"]`);
        if (!highlight) return;
        highlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
        openHighlight(highlight, { focusTextarea: true });
    }

    function showAnnotationMessage(text) {
        if (!annotationMessage) return;
        annotationMessage.textContent = text;
        annotationMessage.classList.add('is-visible');
    }

    function hideAnnotationMessage() {
        if (!annotationMessage) return;
        annotationMessage.textContent = '';
        annotationMessage.classList.remove('is-visible');
    }

    function hideAnnotationPopover() {
        if (!annotationPopover) return;
        annotationPopover.classList.remove('is-visible');
        annotationPopover.setAttribute('aria-hidden', 'true');
        annotationPopover.style.top = '';
        annotationPopover.style.left = '';
    }

    function positionAnnotationPopover() {
        if (!annotationPopover || annotationPopover.getAttribute('aria-hidden') === 'true' || !activeHighlight) {
            return;
        }

        const rect = activeHighlight.getBoundingClientRect();
        const popRect = annotationPopover.getBoundingClientRect();
        const padding = 16;
        let top = rect.bottom + 12;
        if (top + popRect.height > window.innerHeight - padding) {
            top = Math.max(padding, rect.top - popRect.height - 12);
        }
        let left = rect.left + rect.width / 2 - popRect.width / 2;
        left = Math.min(Math.max(left, padding), window.innerWidth - popRect.width - padding);

        annotationPopover.style.top = `${Math.round(top)}px`;
        annotationPopover.style.left = `${Math.round(left)}px`;
    }

    function initializeActivities() {
        initializeCuriosityCarousels();
        initializeKeywordGroups();
    }

    function initializeCuriosityCarousels() {
        const carousels = (slidesRoot || document).querySelectorAll('[data-carousel]');
        carousels.forEach(carousel => {
            if (!carousel || carousel.dataset.bound === 'true') return;
            const track = carousel.querySelector('[data-carousel-track]');
            const slides = track ? Array.from(track.children) : [];
            if (!track || slides.length === 0) {
                carousel.dataset.bound = 'true';
                return;
            }

            const prevBtn = carousel.querySelector('[data-carousel-prev]');
            const nextBtn = carousel.querySelector('[data-carousel-next]');
            const dotsContainer = carousel.querySelector('[data-carousel-dots]');
            let currentIndex = 0;

            const dots = [];
            if (dotsContainer) {
                dotsContainer.innerHTML = '';
                slides.forEach((_, index) => {
                    const dot = document.createElement('button');
                    dot.type = 'button';
                    dot.setAttribute('aria-label', `Go to slide ${index + 1}`);
                    dot.addEventListener('click', () => {
                        currentIndex = index;
                        updateCarousel();
                    });
                    dots.push(dot);
                    dotsContainer.appendChild(dot);
                });
            }

            function updateCarousel() {
                currentIndex = Math.max(0, Math.min(currentIndex, slides.length - 1));
                const targetSlide = slides[currentIndex];
                const offset = targetSlide ? targetSlide.offsetLeft : 0;
                track.style.transform = `translateX(-${offset}px)`;
                if (prevBtn) prevBtn.disabled = currentIndex === 0;
                if (nextBtn) nextBtn.disabled = currentIndex === slides.length - 1;
                dots.forEach((dot, index) => {
                    dot.setAttribute('aria-current', index === currentIndex ? 'true' : 'false');
                });
            }

            prevBtn?.addEventListener('click', () => {
                if (currentIndex > 0) {
                    currentIndex -= 1;
                    updateCarousel();
                }
            });

            nextBtn?.addEventListener('click', () => {
                if (currentIndex < slides.length - 1) {
                    currentIndex += 1;
                    updateCarousel();
                }
            });

            window.addEventListener('resize', updateCarousel);

            carousel.dataset.bound = 'true';
            updateCarousel();
        });
    }

    function initializeKeywordGroups() {
        const groups = (slidesRoot || document).querySelectorAll('[data-choice-group]');
        groups.forEach(group => {
            if (group.dataset.bound === 'true') return;
            const buttons = Array.from(group.querySelectorAll('button'));
            const definitionBox = group.closest('.slide')?.querySelector('.keyword-definition span');
            const defaultDefinition = definitionBox?.textContent || '';

            buttons.forEach(button => {
                button.setAttribute('aria-pressed', 'false');
                button.addEventListener('click', () => {
                    buttons.forEach(btn => {
                        btn.classList.remove('is-selected');
                        btn.setAttribute('aria-pressed', 'false');
                    });
                    button.classList.add('is-selected');
                    button.setAttribute('aria-pressed', 'true');
                    if (definitionBox) {
                        definitionBox.textContent = button.dataset.definition || defaultDefinition;
                    }
                });
            });

            group.dataset.bound = 'true';
        });
    }
});

function checkSelectAnswers(containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    const selects = container.querySelectorAll('select');
    let allCorrect = true;
    selects.forEach(select => {
        const isCorrect = select.value === select.dataset.answer;
        select.style.borderColor = isCorrect ? '#28a745' : '#dc3545';
        select.style.backgroundColor = isCorrect ? '#e9f5ec' : '#fbe9eb';
        if (!isCorrect) allCorrect = false;
    });
}
</script>


</body>
</html>
